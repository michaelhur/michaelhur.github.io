
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Michael&#39;s Dev Story">
    <title>PyMLB: Exploring MLB Data using Python - Michael&#39;s Dev Story</title>
    <meta name="author" content="Michael Hur">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Michael Hur","sameAs":[]},"articleBody":"Sabermetrics: Analysis of BaseballAs Bill James said “sabermetrics is the search for objective knowledge about baseball.” Unlike the classical baseball statistics such as win or home run, it aims to derive statistic that can objectively quantify the players’ performance. For example, in 2018 New York Mets’ rookie pitcher Jacob deGrom has the record of 10 wins and 9 losses. Looking at win-loss ratio, it only implies that he is a mediocre pitcher, but he has received Cy Young Award (the Pitcher of the Year) and Rookie of the Year for his outstanding performance. Over the span of four seasons, he has made 78 starts, in which he has only won 36 and lost 42. During those 78 starts, deGrom only conceived one or less runs in 33 games; yet, he was not able to pick up a win. As the example of Jacob deGrom shows, the classical statistic often fails to correctly reflect the player’s performance. As a result, Sabermetricians have derived statistics such as Wins Above Replacement (WAR), which measures a player’s value as to how many more wins the player contributes to the team in comparison with a replacement player in the same position. deGrom’s WAR was 9.0 in 2018, which in the transfer market translates to approximately $70 million making him one of the most expensive player in the league.\nWhere do we get raw data?Now that we know how important statistics is in baseball and want to be able to compute these more meaningful metrics, we first ened to figure out how to extract raw data. Fortunately, Major League Baseball (MLB) has long made its data public and this post will show you the guid on “how to extract data” from the MLB’s stats API, by extracting each batter’s at-bat outcome in the opening game of the 2021 season. \n\nUnderstanding the API SchemaAlthough we can “brute-force” search every node in the tree until we obtain the desired fruit, the API document actually explains what the available keys are and what parameters the query takes at each level. Since we are interested in finding out the result of each “at-bat” in a specific game, we need to where these “play-by-play” data lies in. A thorough read tells us that such information is stroed under the “game” endpoints which stores all the data pertaining to the “game-level.”\nThis game key requires a game_pk parameter. game_pk is a unique identifier assigned to each game. In order to obtain this game_pk, we will have to look into the schedule operation, which will return all the game on a given date. In short, in order to get the play-by-play data we will have to:\n\nFrom the schedule key, we extract the game_pk of the opening game of 2021 season.\nUsing this game_pk, we extract the play-By-Play data of the corresponding game_pk.\n\nPython ApproachWe have three goals:\n\nFrom the schedule key, we extract the game_pk of the opening game of 2021 season.\nUsing this game_pk, we extract the play-By-Play data of the corresponding game_pk.\nPutting it all together so that we can extract other data with a simple change to the query.\n\nImport Libraries12import requestsimport json\n\n1. Extract game_pk from the schedule endpointsA quick tip: \n\nThe schedule endpoint requires either ‘sportId’ or ‘game_pk’.\nFormer will be used to obtain schedule on the given date(s).\nLatter is used to obtain schedule given the unique game ID. Which seems like a backward operation, but think of the scenario where we want to figure out the detailed schedule such as date, venue or home&#x2F;away of the specific game.\nParameter ‘sportId’ should be 1\n\n12## Production version urlschedule_url = &#x27;http://statsapi.mlb.com/api/v1/schedule?sportId=1&amp;date=04/01/2021&#x27;\n\n123schedule_response = requests.get(schedule_url)schedule_content = schedule_response.contentschedule_json_content = json.loads(schedule_content)\n\nAfter a successful load of the content, we want to see what it looks like:\n1schedule_json_content\nA quick skim of the content implies that the most of the contents are under the key “dates.” To check there are more endpoints of the schedule endpoints:\n1schedule_json_content.keys()\nSince there is no other keys in this json object, we will explore more of the “dates” key.\n12dates_content = schedule_json_content[&#x27;dates&#x27;]dates_content\nThe output object is a list of json object(s). Since we queried only on a single date, we will have one json object in the list. Each ‘date’ json object has multiple “games” tags. Each tag corresponds to a game played on the given date.\n12games_content = dates_content[0][&#x27;games&#x27;]games_content\nAgain, it returns a list of ‘game’ json object. Each ‘game’ object contains the information about each game played on the given date. These information include:\n\ngamePk: The unique ID assigned to each game\nlink: The API link to this game\ngameType: ‘R’ if regular game, ‘P’ if post-season, ‘N’ if pre-season\ngameDate, officialDate: self-explanatory\nstatus: has children tags such as detailedState, which tells us if the game is finished, cancelled, delayed, etc\nteams: teams played the game, their current standings, scores, home&#x2F;away status\n\nSince are interested in obtaining ‘gamePk’ of the opening game:\n12gamePk_opening = games_content[0][&#x27;gamePk&#x27;]gamePk_opening\n\n1634642\n\nTo sum it up, we can find ‘gamePk’ parameter in the following order:\n\nschedule -&gt; dates -&gt; games -&gt; gamePk.\n\nOr (not so) Pythonically:\n12gamePk_opening_alt = schedule_json_content[&#x27;dates&#x27;][0][&#x27;games&#x27;][0][&#x27;gamePk&#x27;]gamePk_opening_alt\n\n1634642\n\n\n2. Using gamePk to extract at-bat dataThe API document says that we need to input the following url:\nhttp://statsapi.mlb.com/api/v1/game/&#123;game_pk&#125;/playByPlay\n1playbyplay_url = &quot;http://statsapi.mlb.com/api/v1/game/634642/playByPlay&quot;\n\nFollowing the same steps as we did with the schedule endpoints:\n123playbyplay_response = requests.get(playbyplay_url)playbyplay_content = playbyplay_response.contentplaybyplay_json_content = json.loads(playbyplay_content)\n\n1playbyplay_json_content\n\nA quick skim of the content implies that the most of the contents are under the key allPlays. \n12allPlays_content = playbyplay_json_content[&#x27;allPlays&#x27;]allPlays_content\n\nAgain, this allPlays object is a list of plays. So we only dig into one for the exploratory work.\n12Play1 = allPlays_content[0]Play1\n\n1Play1.keys()\n\nLooking at the available keys of this endpoint, result key obviously contains the information we want: the outcome of each at bat.\n1Play1[&#x27;result&#x27;]\n\n&#123;&#39;type&#39;: &#39;atBat&#39;,\n &#39;event&#39;: &#39;Groundout&#39;,\n &#39;eventType&#39;: &#39;field_out&#39;,\n &#39;description&#39;: &#39;Marcus Semien grounds out, shortstop Gleyber Torres to first baseman Jay Bruce.&#39;,\n &#39;rbi&#39;: 0,\n &#39;awayScore&#39;: 0,\n &#39;homeScore&#39;: 0&#125;\n\nHere we are. We need to cautious here. type attributes implies that there could be play type that is not atBat.\nSo we loop through each play and filter out ones whose type is not atBat.\n123456789101112play_dict = &#123;&#125;play_count = 0for play in allPlays_content:    if play[&#x27;result&#x27;][&#x27;type&#x27;] != &#x27;atBat&#x27;:        pass        play_count += 1    play_outcome = play[&#x27;result&#x27;][&#x27;eventType&#x27;]        play_dict.update(&#123;play_count: play_outcome&#125;)    \n\n\n1play_dict\n\n&#123;1: &#39;field_out&#39;,\n 2: &#39;strikeout&#39;,\n 3: &#39;field_out&#39;,\n 4: &#39;field_out&#39;,\n 5: &#39;strikeout&#39;,\n 6: &#39;strikeout&#39;,\n 7: &#39;single&#39;,\n 8: &#39;single&#39;,\n 9: &#39;single&#39;,\n 10: &#39;field_out&#39;,\n 11: &#39;strikeout&#39;,\n 12: &#39;strikeout&#39;,\n 13: &#39;field_out&#39;,\n 14: &#39;single&#39;,\n 15: &#39;strikeout&#39;,\n 16: &#39;home_run&#39;,\n 17: &#39;field_out&#39;,\n 18: &#39;field_out&#39;,\n 19: &#39;strikeout&#39;,\n 20: &#39;strikeout&#39;,\n 21: &#39;field_out&#39;,\n 22: &#39;field_out&#39;,\n 23: &#39;field_out&#39;,\n 24: &#39;strikeout&#39;,\n 25: &#39;walk&#39;,\n 26: &#39;strikeout&#39;,\n 27: &#39;field_out&#39;,\n 28: &#39;strikeout&#39;,\n 29: &#39;field_out&#39;,\n 30: &#39;strikeout&#39;,\n 31: &#39;field_out&#39;,\n 32: &#39;single&#39;,\n 33: &#39;field_out&#39;,\n 34: &#39;field_out&#39;,\n 35: &#39;field_out&#39;,\n 36: &#39;field_out&#39;,\n 37: &#39;walk&#39;,\n 38: &#39;single&#39;,\n 39: &#39;field_out&#39;,\n 40: &#39;strikeout&#39;,\n 41: &#39;home_run&#39;,\n 42: &#39;walk&#39;,\n 43: &#39;grounded_into_double_play&#39;,\n 44: &#39;single&#39;,\n 45: &#39;force_out&#39;,\n 46: &#39;strikeout&#39;,\n 47: &#39;walk&#39;,\n 48: &#39;field_out&#39;,\n 49: &#39;field_out&#39;,\n 50: &#39;single&#39;,\n 51: &#39;field_out&#39;,\n 52: &#39;caught_stealing_2b&#39;,\n 53: &#39;single&#39;,\n 54: &#39;field_out&#39;,\n 55: &#39;single&#39;,\n 56: &#39;walk&#39;,\n 57: &#39;grounded_into_double_play&#39;,\n 58: &#39;strikeout&#39;,\n 59: &#39;field_out&#39;,\n 60: &#39;field_out&#39;,\n 61: &#39;walk&#39;,\n 62: &#39;strikeout&#39;,\n 63: &#39;field_out&#39;,\n 64: &#39;strikeout&#39;,\n 65: &#39;single&#39;,\n 66: &#39;field_out&#39;,\n 67: &#39;strikeout&#39;,\n 68: &#39;field_out&#39;,\n 69: &#39;walk&#39;,\n 70: &#39;strikeout&#39;,\n 71: &#39;walk&#39;,\n 72: &#39;fielders_choice_out&#39;,\n 73: &#39;strikeout&#39;,\n 74: &#39;double&#39;,\n 75: &#39;strikeout&#39;,\n 76: &#39;strikeout&#39;,\n 77: &#39;strikeout&#39;,\n 78: &#39;strikeout&#39;,\n 79: &#39;strikeout&#39;,\n 80: &#39;strikeout&#39;&#125;\n\nFinally, we achieved what we wanted. The outcome of each at-bat.\n3. Putting it altogetherFirst we build a helper function that can be used generally.\n123456789101112131415import timedef get_json(url):    ## get_json: str -&gt; json    ## get_json() function takes &#x27;url&#x27; and returns the response in json format from the MLB Stats API.        response = requests.get(url)    if (response.status_code != 200):        print(&#x27;status code: %s&#x27; % response.status_code)        time.sleep(1.0)        get_json(url)    else:        content = response.content        json_content = json.loads(content)        return(json_content)\n\n\n1234567891011121314151617181920def extract_game_id(schedule_json):    ## extract_game_id: json -&gt; listof int    ## extract_game_id() function takes a schedule response object and returns a list of game IDs.        if schedule_json == &#123;&#125;:        return []    gameID_list = []        dates = schedule_json[&#x27;dates&#x27;]        for day in dates:        games = day[&#x27;games&#x27;]                for game in games:            gameID = game[&#x27;gamePk&#x27;]            gameID_list.append(gameID)           return(gameID_list)\n\n\n1234567891011121314151617181920212223242526272829303132333435363738def get_game_ids(date, endDate = None, teamId = None):    ## get_game_ids: str int str str -&gt; listof int    ## get_game_ids() function returns the list of game IDs.    ## date must be of format &quot;YYYY-MM-DD&quot;.     ## If date is used without end_date, then it returns the list of game IDs on the input date.    ## If end_date is inputted, then it returns the list of game IDs in the period of date and end_date.    ## If teamID is inputted, then it will return game ID&#x27;s that the corresponding team played; otherwise, all.            base_schedule_url = &quot;http://statsapi.mlb.com/api/v1/schedule?sportId=1&quot;    alt_base_url = &quot;https://beta-statsapi.mlb.com:443/api/v1/schedule?sportId=1&quot;    suffix = &quot;&quot;    if endDate is not None:        suffix = &quot;&amp;startDate=&quot; + date + &quot;&amp;endDate=&quot; + endDate        else:        suffix = &quot;&amp;date=&quot; + date            if teamId is not None:        suffix = suffix + &quot;&amp;teamId=&quot; + str(teamId)                try:        url = base_schedule_url + suffix        #print(url)        schedule_content = get_json(url)        #print(&#x27;status code: %s&#x27; % response.status_code)    except:        #print(&#x27;Trying alternate route...&#x27;)        url = alt_base_url + suffix        #print(url)        schedule_content = get_json(url)       gameIDs = extract_game_id(schedule_content)    return(gameIDs)\n\n\n123456789101112131415161718192021222324252627282930313233def get_atbat_outcome(listofgameIDs):        gameID_dict = &#123;&#125;        for gameID in listofgameIDs:                try:            url =  &quot;http://statsapi.mlb.com/api/v1/game/&quot; + str(gameID) + &quot;/playByPlay&quot;            playbyplay_content = get_json(url)                    except:            #print(&#x27;Trying alternate route...&#x27;)            url = &quot;https://beta-statsapi.mlb.com:443/api/v1/game&quot; + str(gameID) + &quot;/playByPlay&quot;            playbyplay_content = get_json(url)            allPlays_content = playbyplay_content[&#x27;allPlays&#x27;]            play_dict = &#123;&#125;        play_count = 0        for play in allPlays_content:            if play[&#x27;result&#x27;][&#x27;type&#x27;] != &#x27;atBat&#x27;:                pass            play_count += 1            play_outcome = play[&#x27;result&#x27;][&#x27;eventType&#x27;]            play_dict.update(&#123;play_count: play_outcome&#125;)                    gameID_dict.update(&#123;gameID:play_dict&#125;)            return(gameID_dict)\n\n\n","dateCreated":"2022-04-09T23:35:04+09:00","dateModified":"2021-06-17T00:42:31+09:00","datePublished":"2022-04-09T23:35:04+09:00","description":"","headline":"PyMLB: Exploring MLB Data using Python","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"},"publisher":{"@type":"Organization","name":"Michael Hur","sameAs":[]},"url":"http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/","keywords":"Python, API, Wrapper, Baseball, MLB, Data"}</script>
    <meta name="description" content="Sabermetrics: Analysis of BaseballAs Bill James said “sabermetrics is the search for objective knowledge about baseball.” Unlike the classical baseball statistics such as win or home run, it aims to d">
<meta property="og:type" content="blog">
<meta property="og:title" content="PyMLB: Exploring MLB Data using Python">
<meta property="og:url" content="http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/index.html">
<meta property="og:site_name" content="Michael&#39;s Dev Story">
<meta property="og:description" content="Sabermetrics: Analysis of BaseballAs Bill James said “sabermetrics is the search for objective knowledge about baseball.” Unlike the classical baseball statistics such as win or home run, it aims to d">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://michaelhur.github.io/images/20210602/screenshot1.png">
<meta property="og:image" content="https://michaelhur.github.io/images/20210602/screenshot2.png">
<meta property="article:published_time" content="2022-04-09T14:35:04.930Z">
<meta property="article:modified_time" content="2021-06-16T15:42:31.000Z">
<meta property="article:author" content="Michael Hur">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="API">
<meta property="article:tag" content="Wrapper">
<meta property="article:tag" content="Baseball">
<meta property="article:tag" content="MLB">
<meta property="article:tag" content="Data">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://michaelhur.github.io/images/20210602/screenshot1.png">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-tt5otrcfnyzi0refn9zrhtfrt4xlibymuuibvd4oaixntnzpzpm8wmtxdjom.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Michael&#39;s Dev Story
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/michaelhur"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:jhhur716@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            PyMLB: Exploring MLB Data using Python
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-04-09T23:35:04+09:00">
	
		    Apr 09, 2022
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h3 id="Sabermetrics-Analysis-of-Baseball"><a href="#Sabermetrics-Analysis-of-Baseball" class="headerlink" title="Sabermetrics: Analysis of Baseball"></a>Sabermetrics: Analysis of Baseball</h3><p>As Bill James said “sabermetrics is the search for objective knowledge about baseball.” Unlike the classical baseball statistics such as win or home run, it aims to derive statistic that can objectively quantify the players’ performance. For example, in 2018 New York Mets’ rookie pitcher Jacob deGrom has the record of 10 wins and 9 losses. Looking at win-loss ratio, it only implies that he is a mediocre pitcher, but he has received Cy Young Award (the Pitcher of the Year) and Rookie of the Year for his outstanding performance. <a target="_blank" rel="noopener" href="https://www.fangraphs.com/players/jacob-degrom/10954/stats?position=P">Over the span of four seasons, he has made 78 starts, in which he has only won 36 and lost 42.</a> During those 78 starts, <a target="_blank" rel="noopener" href="https://www.espn.com/mlb/story/_/id/31354867/new-york-mets-ace-jacob-degrom-lack-run-support-reaching-new-lows">deGrom only conceived one or less runs in 33 games; yet, he was not able to pick up a win.</a> As the example of Jacob deGrom shows, the classical statistic often fails to correctly reflect the player’s performance. As a result, Sabermetricians have derived statistics such as Wins Above Replacement (WAR), which measures a player’s value as to how many more wins the player contributes to the team in comparison with a replacement player in the same position. deGrom’s WAR was 9.0 in 2018, which in the transfer market translates to approximately $70 million making him one of the most expensive player in the league.</p>
<h3 id="Where-do-we-get-raw-data"><a href="#Where-do-we-get-raw-data" class="headerlink" title="Where do we get raw data?"></a>Where do we get raw data?</h3><p>Now that we know how important statistics is in baseball and want to be able to compute these more meaningful metrics, we first ened to figure out how to extract raw data. Fortunately, <a target="_blank" rel="noopener" href="https://statsapi.mlb.com/api/">Major League Baseball (MLB) has long made its data public</a> and this post will show you the guid on “how to extract data” from the MLB’s stats API, by extracting each batter’s at-bat outcome in the opening game of the 2021 season. </p>
<p><img src="https://michaelhur.github.io/images/20210602/screenshot1.png" alt="Excerpt from the MLB&#39;s Stats API"></p>
<h3 id="Understanding-the-API-Schema"><a href="#Understanding-the-API-Schema" class="headerlink" title="Understanding the API Schema"></a>Understanding the API Schema</h3><p>Although we can “brute-force” search every node in the tree until we obtain the desired fruit, the <a target="_blank" rel="noopener" href="https://beta-statsapi.mlb.com/docs/">API document</a> actually explains what the available keys are and what parameters the query takes at each level. Since we are interested in finding out the result of each “at-bat” in a specific game, we need to where these “play-by-play” data lies in. A thorough read tells us that such information is stroed under the “game” endpoints which stores all the data pertaining to the “game-level.”<br><img src="https://michaelhur.github.io/images/20210602/screenshot2.png" alt="The &quot;Game&quot; endpoints of the MLB&#39;s Stats API"></p>
<p>This <code>game</code> key requires a <code>game_pk</code> parameter. <code>game_pk</code> is a unique identifier assigned to each game. In order to obtain this <code>game_pk</code>, we will have to look into the <code>schedule</code> operation, which will return all the game on a given date. In short, in order to get the <code>play-by-play</code> data we will have to:</p>
<ol>
<li>From the <code>schedule</code> key, we extract the <code>game_pk</code> of the opening game of 2021 season.</li>
<li>Using this <code>game_pk</code>, we extract the <code>play-By-Play</code> data of the corresponding <code>game_pk.</code></li>
</ol>
<h3 id="Python-Approach"><a href="#Python-Approach" class="headerlink" title="Python Approach"></a>Python Approach</h3><p>We have three goals:</p>
<ol>
<li>From the <code>schedule</code> key, we extract the <code>game_pk</code> of the opening game of 2021 season.</li>
<li>Using this <code>game_pk</code>, we extract the <code>play-By-Play</code> data of the corresponding <code>game_pk.</code></li>
<li>Putting it all together so that we can extract other data with a simple change to the query.</li>
</ol>
<h2 id="Import-Libraries"><a href="#Import-Libraries" class="headerlink" title="Import Libraries"></a>Import Libraries</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br></pre></td></tr></table></figure>

<h3 id="1-Extract-game-pk-from-the-schedule-endpoints"><a href="#1-Extract-game-pk-from-the-schedule-endpoints" class="headerlink" title="1. Extract game_pk from the schedule endpoints"></a>1. Extract <code>game_pk</code> from the <code>schedule</code> endpoints</h3><p>A quick tip: </p>
<ul>
<li>The schedule endpoint requires either ‘sportId’ or ‘game_pk’.</li>
<li>Former will be used to obtain schedule on the given date(s).</li>
<li>Latter is used to obtain schedule given the unique game ID. Which seems like a backward operation, but think of the scenario where we want to figure out the detailed schedule such as date, venue or home&#x2F;away of the specific game.</li>
<li>Parameter ‘sportId’ should be 1</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Production version url</span></span><br><span class="line">schedule_url = <span class="string">&#x27;http://statsapi.mlb.com/api/v1/schedule?sportId=1&amp;date=04/01/2021&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">schedule_response = requests.get(schedule_url)</span><br><span class="line">schedule_content = schedule_response.content</span><br><span class="line">schedule_json_content = json.loads(schedule_content)</span><br></pre></td></tr></table></figure>

<p>After a successful load of the content, we want to see what it looks like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schedule_json_content</span><br></pre></td></tr></table></figure>
<p>A quick skim of the content implies that the most of the contents are under the key “dates.” To check there are more endpoints of the schedule endpoints:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schedule_json_content.keys()</span><br></pre></td></tr></table></figure>
<p>Since there is no other keys in this json object, we will explore more of the “dates” key.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dates_content = schedule_json_content[<span class="string">&#x27;dates&#x27;</span>]</span><br><span class="line">dates_content</span><br></pre></td></tr></table></figure>
<p>The output object is a list of json object(s). Since we queried only on a single date, we will have one json object in the list. Each ‘date’ json object has multiple “games” tags. Each tag corresponds to a game played on the given date.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">games_content = dates_content[<span class="number">0</span>][<span class="string">&#x27;games&#x27;</span>]</span><br><span class="line">games_content</span><br></pre></td></tr></table></figure>
<p>Again, it returns a list of ‘game’ json object. Each ‘game’ object contains the information about each game played on the given date. These information include:</p>
<ul>
<li>gamePk: The unique ID assigned to each game</li>
<li>link: The API link to this game</li>
<li>gameType: ‘R’ if regular game, ‘P’ if post-season, ‘N’ if pre-season</li>
<li>gameDate, officialDate: self-explanatory</li>
<li>status: has children tags such as detailedState, which tells us if the game is finished, cancelled, delayed, etc</li>
<li>teams: teams played the game, their current standings, scores, home&#x2F;away status</li>
</ul>
<p>Since are interested in obtaining ‘gamePk’ of the opening game:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gamePk_opening = games_content[<span class="number">0</span>][<span class="string">&#x27;gamePk&#x27;</span>]</span><br><span class="line">gamePk_opening</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">634642</span></span><br></pre></td></tr></table></figure>

<p>To sum it up, we can find ‘gamePk’ parameter in the following order:</p>
<ul>
<li>schedule -&gt; dates -&gt; games -&gt; gamePk.</li>
</ul>
<p>Or (not so) Pythonically:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gamePk_opening_alt = schedule_json_content[<span class="string">&#x27;dates&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;games&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;gamePk&#x27;</span>]</span><br><span class="line">gamePk_opening_alt</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">634642</span></span><br></pre></td></tr></table></figure>


<h3 id="2-Using-gamePk-to-extract-at-bat-data"><a href="#2-Using-gamePk-to-extract-at-bat-data" class="headerlink" title="2. Using gamePk to extract at-bat data"></a>2. Using <code>gamePk</code> to extract <code>at-bat</code> data</h3><p><a target="_blank" rel="noopener" href="https://beta-statsapi.mlb.com/docs/#!/game/playByPlay">The API document</a> says that we need to input the following url:</p>
<p><code>http://statsapi.mlb.com/api/v1/game/&#123;game_pk&#125;/playByPlay</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">playbyplay_url = <span class="string">&quot;http://statsapi.mlb.com/api/v1/game/634642/playByPlay&quot;</span></span><br></pre></td></tr></table></figure>

<p>Following the same steps as we did with the schedule endpoints:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">playbyplay_response = requests.get(playbyplay_url)</span><br><span class="line">playbyplay_content = playbyplay_response.content</span><br><span class="line">playbyplay_json_content = json.loads(playbyplay_content)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">playbyplay_json_content</span><br></pre></td></tr></table></figure>

<p>A quick skim of the content implies that the most of the contents are under the key <code>allPlays</code>. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allPlays_content = playbyplay_json_content[<span class="string">&#x27;allPlays&#x27;</span>]</span><br><span class="line">allPlays_content</span><br></pre></td></tr></table></figure>

<p>Again, this <code>allPlays</code> object is a list of <code>plays</code>. So we only dig into one for the exploratory work.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Play1 = allPlays_content[<span class="number">0</span>]</span><br><span class="line">Play1</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Play1.keys()</span><br></pre></td></tr></table></figure>

<p>Looking at the available keys of this endpoint, <code>result</code> key obviously contains the information we want: the outcome of each at bat.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Play1[<span class="string">&#x27;result&#x27;</span>]</span><br></pre></td></tr></table></figure>

<pre><code>&#123;&#39;type&#39;: &#39;atBat&#39;,
 &#39;event&#39;: &#39;Groundout&#39;,
 &#39;eventType&#39;: &#39;field_out&#39;,
 &#39;description&#39;: &#39;Marcus Semien grounds out, shortstop Gleyber Torres to first baseman Jay Bruce.&#39;,
 &#39;rbi&#39;: 0,
 &#39;awayScore&#39;: 0,
 &#39;homeScore&#39;: 0&#125;
</code></pre>
<p>Here we are. We need to cautious here. <code>type</code> attributes implies that there could be play type that is not <code>atBat</code>.</p>
<p>So we loop through each play and filter out ones whose type is not <code>atBat</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">play_dict = &#123;&#125;</span><br><span class="line">play_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> play <span class="keyword">in</span> allPlays_content:</span><br><span class="line">    <span class="keyword">if</span> play[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] != <span class="string">&#x27;atBat&#x27;</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    play_count += <span class="number">1</span></span><br><span class="line">    play_outcome = play[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;eventType&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    play_dict.update(&#123;play_count: play_outcome&#125;)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">play_dict</span><br></pre></td></tr></table></figure>

<pre><code>&#123;1: &#39;field_out&#39;,
 2: &#39;strikeout&#39;,
 3: &#39;field_out&#39;,
 4: &#39;field_out&#39;,
 5: &#39;strikeout&#39;,
 6: &#39;strikeout&#39;,
 7: &#39;single&#39;,
 8: &#39;single&#39;,
 9: &#39;single&#39;,
 10: &#39;field_out&#39;,
 11: &#39;strikeout&#39;,
 12: &#39;strikeout&#39;,
 13: &#39;field_out&#39;,
 14: &#39;single&#39;,
 15: &#39;strikeout&#39;,
 16: &#39;home_run&#39;,
 17: &#39;field_out&#39;,
 18: &#39;field_out&#39;,
 19: &#39;strikeout&#39;,
 20: &#39;strikeout&#39;,
 21: &#39;field_out&#39;,
 22: &#39;field_out&#39;,
 23: &#39;field_out&#39;,
 24: &#39;strikeout&#39;,
 25: &#39;walk&#39;,
 26: &#39;strikeout&#39;,
 27: &#39;field_out&#39;,
 28: &#39;strikeout&#39;,
 29: &#39;field_out&#39;,
 30: &#39;strikeout&#39;,
 31: &#39;field_out&#39;,
 32: &#39;single&#39;,
 33: &#39;field_out&#39;,
 34: &#39;field_out&#39;,
 35: &#39;field_out&#39;,
 36: &#39;field_out&#39;,
 37: &#39;walk&#39;,
 38: &#39;single&#39;,
 39: &#39;field_out&#39;,
 40: &#39;strikeout&#39;,
 41: &#39;home_run&#39;,
 42: &#39;walk&#39;,
 43: &#39;grounded_into_double_play&#39;,
 44: &#39;single&#39;,
 45: &#39;force_out&#39;,
 46: &#39;strikeout&#39;,
 47: &#39;walk&#39;,
 48: &#39;field_out&#39;,
 49: &#39;field_out&#39;,
 50: &#39;single&#39;,
 51: &#39;field_out&#39;,
 52: &#39;caught_stealing_2b&#39;,
 53: &#39;single&#39;,
 54: &#39;field_out&#39;,
 55: &#39;single&#39;,
 56: &#39;walk&#39;,
 57: &#39;grounded_into_double_play&#39;,
 58: &#39;strikeout&#39;,
 59: &#39;field_out&#39;,
 60: &#39;field_out&#39;,
 61: &#39;walk&#39;,
 62: &#39;strikeout&#39;,
 63: &#39;field_out&#39;,
 64: &#39;strikeout&#39;,
 65: &#39;single&#39;,
 66: &#39;field_out&#39;,
 67: &#39;strikeout&#39;,
 68: &#39;field_out&#39;,
 69: &#39;walk&#39;,
 70: &#39;strikeout&#39;,
 71: &#39;walk&#39;,
 72: &#39;fielders_choice_out&#39;,
 73: &#39;strikeout&#39;,
 74: &#39;double&#39;,
 75: &#39;strikeout&#39;,
 76: &#39;strikeout&#39;,
 77: &#39;strikeout&#39;,
 78: &#39;strikeout&#39;,
 79: &#39;strikeout&#39;,
 80: &#39;strikeout&#39;&#125;
</code></pre>
<p>Finally, we achieved what we wanted. The outcome of each at-bat.</p>
<h3 id="3-Putting-it-altogether"><a href="#3-Putting-it-altogether" class="headerlink" title="3. Putting it altogether"></a>3. Putting it altogether</h3><p>First we build a helper function that can be used generally.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_json</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="comment">## get_json: str -&gt; json</span></span><br><span class="line">    <span class="comment">## get_json() function takes &#x27;url&#x27; and returns the response in json format from the MLB Stats API.</span></span><br><span class="line">    </span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> (response.status_code != <span class="number">200</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;status code: %s&#x27;</span> % response.status_code)</span><br><span class="line">        time.sleep(<span class="number">1.0</span>)</span><br><span class="line">        get_json(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content = response.content</span><br><span class="line">        json_content = json.loads(content)</span><br><span class="line">        <span class="keyword">return</span>(json_content)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extract_game_id</span>(<span class="params">schedule_json</span>):</span><br><span class="line">    <span class="comment">## extract_game_id: json -&gt; listof int</span></span><br><span class="line">    <span class="comment">## extract_game_id() function takes a schedule response object and returns a list of game IDs.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> schedule_json == &#123;&#125;:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">    gameID_list = []</span><br><span class="line">    </span><br><span class="line">    dates = schedule_json[<span class="string">&#x27;dates&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> day <span class="keyword">in</span> dates:</span><br><span class="line">        games = day[<span class="string">&#x27;games&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> game <span class="keyword">in</span> games:</span><br><span class="line">            gameID = game[<span class="string">&#x27;gamePk&#x27;</span>]</span><br><span class="line">            gameID_list.append(gameID)</span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span>(gameID_list)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_game_ids</span>(<span class="params">date, endDate = <span class="literal">None</span>, teamId = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="comment">## get_game_ids: str int str str -&gt; listof int</span></span><br><span class="line">    <span class="comment">## get_game_ids() function returns the list of game IDs.</span></span><br><span class="line">    <span class="comment">## date must be of format &quot;YYYY-MM-DD&quot;. </span></span><br><span class="line">    <span class="comment">## If date is used without end_date, then it returns the list of game IDs on the input date.</span></span><br><span class="line">    <span class="comment">## If end_date is inputted, then it returns the list of game IDs in the period of date and end_date.</span></span><br><span class="line">    <span class="comment">## If teamID is inputted, then it will return game ID&#x27;s that the corresponding team played; otherwise, all.</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    base_schedule_url = <span class="string">&quot;http://statsapi.mlb.com/api/v1/schedule?sportId=1&quot;</span></span><br><span class="line">    alt_base_url = <span class="string">&quot;https://beta-statsapi.mlb.com:443/api/v1/schedule?sportId=1&quot;</span></span><br><span class="line">    suffix = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> endDate <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        suffix = <span class="string">&quot;&amp;startDate=&quot;</span> + date + <span class="string">&quot;&amp;endDate=&quot;</span> + endDate</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        suffix = <span class="string">&quot;&amp;date=&quot;</span> + date</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> teamId <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        suffix = suffix + <span class="string">&quot;&amp;teamId=&quot;</span> + <span class="built_in">str</span>(teamId)</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = base_schedule_url + suffix</span><br><span class="line">        <span class="comment">#print(url)</span></span><br><span class="line">        schedule_content = get_json(url)</span><br><span class="line">        <span class="comment">#print(&#x27;status code: %s&#x27; % response.status_code)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="comment">#print(&#x27;Trying alternate route...&#x27;)</span></span><br><span class="line">        url = alt_base_url + suffix</span><br><span class="line">        <span class="comment">#print(url)</span></span><br><span class="line">        schedule_content = get_json(url)</span><br><span class="line">   </span><br><span class="line">    gameIDs = extract_game_id(schedule_content)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>(gameIDs)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_atbat_outcome</span>(<span class="params">listofgameIDs</span>):</span><br><span class="line">    </span><br><span class="line">    gameID_dict = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> gameID <span class="keyword">in</span> listofgameIDs:</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url =  <span class="string">&quot;http://statsapi.mlb.com/api/v1/game/&quot;</span> + <span class="built_in">str</span>(gameID) + <span class="string">&quot;/playByPlay&quot;</span></span><br><span class="line">            playbyplay_content = get_json(url)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="comment">#print(&#x27;Trying alternate route...&#x27;)</span></span><br><span class="line">            url = <span class="string">&quot;https://beta-statsapi.mlb.com:443/api/v1/game&quot;</span> + <span class="built_in">str</span>(gameID) + <span class="string">&quot;/playByPlay&quot;</span></span><br><span class="line">            playbyplay_content = get_json(url)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">        allPlays_content = playbyplay_content[<span class="string">&#x27;allPlays&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">        play_dict = &#123;&#125;</span><br><span class="line">        play_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> play <span class="keyword">in</span> allPlays_content:</span><br><span class="line">            <span class="keyword">if</span> play[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] != <span class="string">&#x27;atBat&#x27;</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">            play_count += <span class="number">1</span></span><br><span class="line">            play_outcome = play[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;eventType&#x27;</span>]</span><br><span class="line"></span><br><span class="line">            play_dict.update(&#123;play_count: play_outcome&#125;)</span><br><span class="line">            </span><br><span class="line">        gameID_dict.update(&#123;gameID:play_dict&#125;)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span>(gameID_dict)</span><br></pre></td></tr></table></figure>



            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/API/" rel="tag">API</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Baseball/" rel="tag">Baseball</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Data/" rel="tag">Data</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/MLB/" rel="tag">MLB</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Python/" rel="tag">Python</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Wrapper/" rel="tag">Wrapper</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/09/2021-06-02-Blogging-with-github/"
                    data-tooltip="Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기"
                    aria-label="PREVIOUS: Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/09/2021-06-04-MongoDB/"
                    data-tooltip="NoSQL and SQL - Part 1"
                    aria-label="NEXT: NoSQL and SQL - Part 1"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 Michael Hur. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/09/2021-06-02-Blogging-with-github/"
                    data-tooltip="Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기"
                    aria-label="PREVIOUS: Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/09/2021-06-04-MongoDB/"
                    data-tooltip="NoSQL and SQL - Part 1"
                    aria-label="NEXT: NoSQL and SQL - Part 1"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Michael Hur</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-zoi9cv3fxbuk68sxg0xkjhah3klemljfujipeswdtomoblnegzlm06beywp6.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
