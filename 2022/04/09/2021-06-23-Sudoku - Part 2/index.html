
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Michael&#39;s Dev Story">
    <title>Sudoku: A systemic approach to Sudoku - Part 2 - Michael&#39;s Dev Story</title>
    <meta name="author" content="Michael Hur">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Michael Hur","sameAs":[],"image":"https://www.gravatar.com/avatar/e07c234b1bdc4490874a9182a531f9ba"},"articleBody":"Rule of Sudoku\nEvery square has to contain a single number\n\nOnly the numbers between 1 and 9 (inclusive) can be used\n\nEach 3×3 subgrid can only contain each number from 1 to 9 once\n\nEach column can only contain each number from 1 to 9 once\n\nEach row can only contain each number from 1 to 9 once\n\n\nApproachesGiven an unsolved sudoku puzzle, our approach is to\n2. Crook’s algorithmCrook’s algorithm is basically is how a human being would solve the problem. There are a few terms that we need to define in order to put them together\n\nMark-up: a mark-up of a cell is a list of all the possible given the numbers that are already in the grid. For example, the mark-up of the very first cell of the grid below is 5 and 7. We can use mark-up instead of trying each number between 1 and 9. This means a fewer cheks to do and shorter computing time.\n\n\n\nPreemptive set is a list of k numbers (2 &lt;&#x3D; k &lt;&#x3D; 8), each between 1 and 9, with the property that only those k numbers can fill k cells. For example, mark-ups in cell (1,1) and (2,1) for a preemptive set of (5, 7). Those 2 cells can be filled in by only (5, 7) which is a set of 2 numbers. \n This might sound ambiguous, but is very useful when eliminating candidates from the mark-up of a cell in the same column (or row or 3x3 subgrid). Since numbers 5 and 7 must each occupy one of cells (1, 1) and (2, 1), 5 cannot be in the cell (8,1) in the same column. 5 is then eliminated from the mark-up of the cell (8,1), leaving it with the only one candidate 4. i.e. the cell (8,1) must be filled with 4.\n\n\n\nCrook’s Algorithm\nMark up all the empty cells.\n a) If the mark-up consists of only one number, fill in the cell with the number.\n b) Remove such number from the mark-up of the cells in the same row, column and subgrid.\n\nFind preemptive sets.\n a) Whenever a preemptive set is found, cross out the numbers in the preemptive set from the mark-up of the cells in the same row, column or subgrid.\n b) Repeat until you find no more preemtive set or rule of Sudoku is violated.\n\nIf the sudoku is not solved by then, or rule of sudoku has not been violated, apply backtracking method from here, but only using the numbers the mark-up instead of all the numbers from 1 to 9.\n\n\nHelper FunctionsWe will build helper functions that check rules of sudoku.\n12345678910111213141516171819## This puts above two rule checkers together into one function.def check_conditions(grid, row, col, n):       ## check_conditions: list of lists, int, int, int -&gt; boolean        if n in grid[row]:        return False        if any([r[col] == n for r in grid]):        return False        r_start = (row // 3) * 3    c_start = (col // 3) * 3        for r, c in itertools.product(range(3),range(3)):        if grid[r_start + r][c_start + c] == n:            return False            return True\n\n\n12345678def next_empty(grid):    ## next_empty(): listof lists -&gt; int, int    ## next_empty() is a helper function that searches for the next empty cell in the given sudoku puzzle    for row in grid:        if 0 in row:            return (grid.index(row), row.index(0))            return None, None\n\n\n123456789101112131415161718192021222324def validateSolution(sudoku):    ## To check if it is a valid solution:        ## If any cell is empty:    if any([0 in row for row in sudoku]):        return(False)        for n in range(1,10):        for row in sudoku:            if n not in row:                return(False)                        for col in range(9):                if n not in [r[col] for r in sudoku]:                    return(False)                            ## In fact, if row and column-wise conditions are met, then subgrid condition is automatically met.         ## But we want to check it explicitly.        for r_start, c_start in itertools.product(range(3),range(3)):            if not any([n not in row[c_start * 3: c_start * 3 + 3] for row in grid[r_start * 3: r_start * 3 + 3]]):                return(False)                return(True)\n\nCrook’s Algorithm\nMark up all the empty cells.\n a) If the mark-up consists of only one number, fill in the cell with the number.\n b) Remove such number from the mark-up of the cells in the same row, column and subgrid.\n\nFind preemptive sets.\n a) Whenever a preemptive set is found, cross out the numbers in the preemptive set from the mark-up of the cells in the same row, column or subgrid.\n b) Repeat until you find no more preemtive set or rule of Sudoku is violated.\n\nIf the sudoku is not solved by then, or rule of sudoku has not been violated, pick any empty cell. Make a guess (i.e. pick a number from the markups), then repeat steps 1 and 2 until you can reduce it as much as possible. Repeat step 3 until the rule is violated or the puzzle is solved.\n\n\nBreakdowns:Mark up\nDefine a function that finds the mark-up of an empty cell.\n\n\ncheck_conditions() function come in handy.\n\nHunch is that we find the row and column index of an empty cell using the next_empty() function, then use check_conditions() function to find mark-ups.\n\n\n123456789grid = [[2,9,5,7,0,0,8,6,0],         [0,3,1,8,6,5,0,2,0],         [8,0,6,0,0,0,0,0,0],         [0,0,7,0,5,0,0,0,6],         [0,0,0,3,8,7,0,0,0],         [5,0,0,0,1,6,7,0,0],         [0,0,0,5,0,0,1,0,9],         [0,2,0,6,0,0,3,5,0],         [0,5,4,0,0,8,6,7,2]]\n\nOr more easier to read:\n\n12## Working with one empty cell. The last cell in the first row.r1, c1 = 0, 8\n\n\n12345678import itertools markup = []for candidate in range(1,10):    if check_conditions(grid, r1, c1, candidate):        markup.append(candidate)    markup\n\n\n\n\n[1, 3, 4]\n\nIn order to apply this We cannot use next_empty() without making some manipulation to the function, since there is no insertion at this point. So we will simply loop through each and every cell for the time being\n1234567891011121314151617markup_list = []for row in range(9):    r = [[]]*9        for col in range(9):        markup = []        if grid[row][col] != 0:            continue        for candidate in range(1,10):            if check_conditions(grid, row, col, candidate):                markup.append(candidate)        r[col] = markup    markup_list.append(r)\n\n\n1markup_list\n\n\n\n\n[[[], [], [], [], [3, 4], [1, 3, 4], [], [], [1, 3, 4]],\n [[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]],\n [[],\n  [4, 7],\n  [],\n  [1, 2, 4, 9],\n  [2, 3, 4, 9],\n  [1, 2, 3, 4, 9],\n  [4, 5, 9],\n  [1, 3, 4, 9],\n  [1, 3, 4, 5, 7]],\n [[1, 3, 4, 9],\n  [1, 4, 8],\n  [],\n  [2, 4, 9],\n  [],\n  [2, 4, 9],\n  [2, 4, 9],\n  [1, 3, 4, 8, 9],\n  []],\n [[1, 4, 6, 9],\n  [1, 4, 6],\n  [2, 9],\n  [],\n  [],\n  [],\n  [2, 4, 5, 9],\n  [1, 4, 9],\n  [1, 4, 5]],\n [[], [4, 8], [2, 3, 8, 9], [2, 4, 9], [], [], [], [3, 4, 8, 9], [3, 4, 8]],\n [[3, 6, 7], [6, 7, 8], [3, 8], [], [2, 3, 4, 7], [2, 3, 4], [], [4, 8], []],\n [[1, 7, 9], [], [8, 9], [], [4, 7, 9], [1, 4, 9], [], [], [4, 8]],\n [[1, 3, 9], [], [], [1, 9], [3, 9], [], [], [], []]]\n\n\nPutting it into a function so that we can use it repeatedly.\n1234567891011121314151617181920212223def get_markup(grid):    ## get_markup(): listof listof int -&gt; listof listof int    ## This helper function returns a list of list of integers    ## where each list of integer is a markup of a corresponding cell     markup_list = []    for row in range(9):        r = [[]]*9        for col in range(9):            markup = []            if grid[row][col] != 0:                continue            for candidate in range(1,10):                if check_conditions(grid, row, col, candidate):                    markup.append(candidate)            r[col] = markup        markup_list.append(r)            return(markup_list)\n\n\n12markups = get_markup(grid)markups\n\n\n\n\n[[[], [], [], [], [3, 4], [1, 3, 4], [], [], [1, 3, 4]],\n [[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]],\n [[],\n  [4, 7],\n  [],\n  [1, 2, 4, 9],\n  [2, 3, 4, 9],\n  [1, 2, 3, 4, 9],\n  [4, 5, 9],\n  [1, 3, 4, 9],\n  [1, 3, 4, 5, 7]],\n [[1, 3, 4, 9],\n  [1, 4, 8],\n  [],\n  [2, 4, 9],\n  [],\n  [2, 4, 9],\n  [2, 4, 9],\n  [1, 3, 4, 8, 9],\n  []],\n [[1, 4, 6, 9],\n  [1, 4, 6],\n  [2, 9],\n  [],\n  [],\n  [],\n  [2, 4, 5, 9],\n  [1, 4, 9],\n  [1, 4, 5]],\n [[], [4, 8], [2, 3, 8, 9], [2, 4, 9], [], [], [], [3, 4, 8, 9], [3, 4, 8]],\n [[3, 6, 7], [6, 7, 8], [3, 8], [], [2, 3, 4, 7], [2, 3, 4], [], [4, 8], []],\n [[1, 7, 9], [], [8, 9], [], [4, 7, 9], [1, 4, 9], [], [], [4, 8]],\n [[1, 3, 9], [], [], [1, 9], [3, 9], [], [], [], []]]\n\nPreemptive setHere, we will work with the markups to find the preemptive set. First we will try to find the preemptive set then find a way to find smaller set by eliminating.\nFor a list of m numbers to be preemptive, it must have m different cells with the same m markups.\n123## r2 is the second row of the gridr2 =   [[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]]r2\n\n\n\n\n[[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]]\n\n123456789preemptive_list = []for m in r2:    if len(m) != 0:        if len(m) == r2.count(m):            if m not in preemptive_list:                preemptive_list.append(m)                preemptive_list            \n\n\n\n\n[[4, 7]]\n\nNow we want to eliminate these numbers from other cell’s markups.\n12for p in preemptive_list:    print([[y for y in x if (y not in p)] if x != p else p for x in r2])\n\n[[4, 7], [], [], [], [], [], [9], [], [4, 7]]\n\nThis can be easily manipulated to be applied to column-wise and subgrid-wise operation.\nPutting it altogether so that we find preemptive sets for each column, row and subgrid, then eliminate markups using those preemptive sets.\nWe will first define functions to do so:\n123456789def get_preemptive(listofMarkup):        preemptive_list = []    for m in listofMarkup:        if len(m) != 0:            if len(m) == listofMarkup.count(m):                if m not in preemptive_list:                    preemptive_list.append(m)    return(preemptive_list)\n\n\n1get_preemptive(get_markup(grid)[1])\n\n\n\n\n[[4, 7]]\n\n1234567def reduce_markup(listofMarkup, preemptive_list):    # compute row-, col- or subgrid-wise    if len(preemptive_list) == 0:        return(listofMarkup)        for p in preemptive_list:        return([[m for m in l if (m not in p)] if l != p else p for l in listofMarkup])\n\n\n123456789grid = [[2,9,5,7,0,0,8,6,0],         [0,3,1,8,6,5,0,2,0],         [8,0,6,0,0,0,0,0,0],         [0,0,7,0,5,0,0,0,6],         [0,0,0,3,8,7,0,0,0],         [5,0,0,0,1,6,7,0,0],         [0,0,0,5,0,0,1,0,9],         [0,2,0,6,0,0,3,5,0],         [0,5,4,0,0,8,6,7,2]]\n\n\n1reduce_markup(get_markup(grid)[1], get_preemptive(get_markup(grid)[1]))\n\n\n\n\n[[4, 7], [], [], [], [], [], [9], [], [4, 7]]\n\nNow putting it all together…\nWe will find markups for all empty cells in the grid\n\nFind preemptive sets for all rows, columns and subgrids, then eliminate candidates from markups\n\nIf only the markup consists of only one candidate, fill in the cell with such number, then remove this number from all markups in the same row, column and subgrid.\n\nRepeat until we cannot reduce the markups\n\n\n1234for row in range(9):    markup = markups[row]    preemptives = get_preemptive(markup)    markup = reduce_markup(markup, preemptives)\n\nThis line will eliminate markups using preemptive sets in each row. Column can be done in the same manner. We will use list(map(list, zip(*l))), where l is a list of our interest, to transpose the list. Will do the same as we do with the row-wise operation, then transpose back.\nFor the subgrid, we will use list index to extract the 3x3 subgrid, find preemptive sets and reduce markups, row by row but with only 3 markups per row.\n12345678910for r_s, c_s in itertools.product(range(3), range(3)):    markup = [r[c_s * 3:c_s * 3 + 3] for r in markups[r_s * 3:r_s * 3 + 3]]    markup = list(itertools.chain(*markup))    preemptives = get_preemptive(markup)    markup = reduce_markup(markup, preemptives)    #print(markup)    #markup_subgrid = [markup[k*3:k*3+3] for k in range(3)]    for i in range(3):        markups[r_s * 3 + i][c_s * 3: c_s * 3 + 3] = markup[i * 3:i * 3 + 3]\n\nPutting it all together. This block of codes will keep reducing until we cannot reduce markups. Note that we will enter the markup into the grid if there is only one candidate for the cell. We will define a function that will find a cell with only one candidate, in the similar manner as the next_empty() function in the previous part.\n12markups = get_markup(grid)[[len(m) for m in listofm] for listofm in markups]\n\n\n\n\n[[0, 0, 0, 0, 2, 3, 0, 0, 3],\n [3, 0, 0, 0, 0, 0, 2, 0, 3],\n [0, 4, 0, 4, 4, 5, 3, 4, 5],\n [5, 4, 0, 3, 0, 3, 3, 5, 0],\n [4, 3, 2, 0, 0, 0, 4, 3, 3],\n [0, 3, 4, 3, 0, 0, 0, 4, 3],\n [4, 4, 2, 0, 4, 3, 0, 2, 0],\n [4, 0, 2, 0, 3, 3, 0, 0, 2],\n [3, 0, 0, 2, 2, 0, 0, 0, 0]]\n\nThis line gives the length (or the number of) of markups in each cell. 0 implies the cell that is already filled in.\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455grid = [[2,9,5,7,0,0,8,6,0],         [0,3,1,8,6,5,0,2,0],         [8,0,6,0,0,0,0,0,0],         [0,0,7,0,5,0,0,0,6],         [0,0,0,3,8,7,0,0,0],         [5,0,0,0,1,6,7,0,0],         [0,0,0,5,0,0,1,0,9],         [0,2,0,6,0,0,3,5,0],         [0,5,4,0,0,8,6,7,2]]markups = get_markup(grid)previous_markups = []def next_definite(markups):    markup_len = [[len(m) for m in listofm] for listofm in markups]        for row in markup_len:        if 1 in row:            return (markup_len.index(row), row.index(1))            return None, Nonewhile markups != previous_markups:        previous_markups = markups        def_row, def_col = next_definite(markups)        if def_row is not None:        grid[def_row][def_col] = markups[def_row][def_col][0]        markups = get_markup(grid)            for row in range(9):        markup = markups[row]        preemptives = get_preemptive(markup)        markup = reduce_markup(markup, preemptives)        markups[row] = markup        markups = list(map(list, zip(*markups)))    for col in range(9):        markup = markups[col]        preemptives = get_preemptive(markup)        markup = reduce_markup(markup, preemptives)        markups[col] = markup    markups = list(map(list, zip(*markups)))         for r_s, c_s in itertools.product(range(3), range(3)):        markup = [r[c_s * 3:c_s * 3 + 3] for r in markups[r_s * 3:r_s * 3 + 3]]        markup = list(itertools.chain(*markup))        preemptives = get_preemptive(markup)        markup = reduce_markup(markup, preemptives)        for i in range(3):            markups[r_s * 3 + i][c_s * 3: c_s * 3 + 3] = markup[i * 3:i * 3 + 3]\n\nNow we have reached the step where the markup can no longer be reduced and we do not have solution yet. We will make a guess on the first empty cell available, then repeat the above step. To make this easier, we will make the above block of codes function.\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455def crook(grid):        markups = get_markup(grid)    previous_markups = []    while markups != previous_markups:        previous_markups = markups#         def_row, def_col = next_definite(markups)#         if def_row is not None:#             grid[def_row][def_col] = markups[def_row][def_col][0]#             markups = get_markup(grid)        for row in range(9):            markup = markups[row]            preemptives = get_preemptive(markup)            markup = reduce_markup(markup, preemptives)            markups[row] = markup        markups = list(map(list, zip(*markups)))        for col in range(9):            markup = markups[col]            preemptives = get_preemptive(markup)            markup = reduce_markup(markup, preemptives)            markups[col] = markup        markups = list(map(list, zip(*markups)))         for r_s, c_s in itertools.product(range(3), range(3)):            markup = [r[c_s * 3:c_s * 3 + 3] for r in markups[r_s * 3:r_s * 3 + 3]]            markup = list(itertools.chain(*markup))            preemptives = get_preemptive(markup)            markup = reduce_markup(markup, preemptives)            for i in range(3):                markups[r_s * 3 + i][c_s * 3: c_s * 3 + 3] = markup[i * 3:i * 3 + 3]        empty_row, empty_col = next_empty(grid)        if empty_row is None:        return(grid)    for guess in markups[empty_row][empty_col]:        #print(&quot;Guess in (&#123;r&#125;,&#123;c&#125;):&#123;n&#125;&quot;.format(r=empty_row, c=empty_col, n=guess))                if check_conditions(grid, empty_row, empty_col, guess):            grid[empty_row][empty_col] = guess            if crook(grid):                return(grid)                grid[empty_row][empty_col] = 0            return False\n\n\n123456789grid = [[2,9,5,7,0,0,8,6,0],         [0,3,1,8,6,5,0,2,0],         [8,0,6,0,0,0,0,0,0],         [0,0,7,0,5,0,0,0,6],         [0,0,0,3,8,7,0,0,0],         [5,0,0,0,1,6,7,0,0],         [0,0,0,5,0,0,1,0,9],         [0,2,0,6,0,0,3,5,0],         [0,5,4,0,0,8,6,7,2]]\n\n\n12grid_sol = crook(grid)grid_sol\n\n\n\n\n[[2, 9, 5, 7, 4, 3, 8, 6, 1],\n [4, 3, 1, 8, 6, 5, 9, 2, 7],\n [8, 7, 6, 1, 9, 2, 5, 4, 3],\n [3, 8, 7, 4, 5, 9, 2, 1, 6],\n [6, 1, 2, 3, 8, 7, 4, 9, 5],\n [5, 4, 9, 2, 1, 6, 7, 3, 8],\n [7, 6, 3, 5, 2, 4, 1, 8, 9],\n [9, 2, 8, 6, 7, 1, 3, 5, 4],\n [1, 5, 4, 9, 3, 8, 6, 7, 2]]\n\n1validateSolution(grid_sol)\n\n\n\n\nTrue\n\nVoila! We solved the sudoku puzzle with the Crook’s algorithm.\nBelow is the code put together so that you can try it yourselves!\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144def check_conditions(grid, row, col, n):       ## check_conditions: list of lists, int, int, int -&gt; boolean        if n in grid[row]:        return False        if any([r[col] == n for r in grid]):        return False        r_start = (row // 3) * 3    c_start = (col // 3) * 3        for r, c in itertools.product(range(3),range(3)):        if grid[r_start + r][c_start + c] == n:            return False            return Truedef get_markup(grid):    ## get_markup(): listof listof int -&gt; listof listof int    ## This helper function returns a list of list of integers    ## where each list of integer is a markup of a corresponding cell     markup_list = []    for row in range(9):        r = [[]]*9        for col in range(9):            markup = []            if grid[row][col] != 0:                continue            for candidate in range(1,10):                if check_conditions(grid, row, col, candidate):                    markup.append(candidate)            r[col] = markup        markup_list.append(r)            return(markup_list)def get_preemptive(listofMarkup):        preemptive_list = []    for m in listofMarkup:        if len(m) != 0:            if len(m) == listofMarkup.count(m):                if m not in preemptive_list:                    preemptive_list.append(m)    return(preemptive_list)def reduce_markup(listofMarkup, preemptive_list):    # compute row-, col- or subgrid-wise    if len(preemptive_list) == 0:        return(listofMarkup)        for p in preemptive_list:        return([[m for m in l if (m not in p)] if l != p else p for l in listofMarkup])def next_empty(grid):    ## next_empty(): listof lists -&gt; int, int    ## next_empty() is a helper function that searches for the next empty cell in the given sudoku puzzle    for row in grid:        if 0 in row:            return (grid.index(row), row.index(0))            return None, Nonedef crook(grid):        markups = get_markup(grid)    previous_markups = []    while markups != previous_markups:        previous_markups = markups        for row in range(9):            markup = markups[row]            preemptives = get_preemptive(markup)            markup = reduce_markup(markup, preemptives)            markups[row] = markup        markups = list(map(list, zip(*markups)))        for col in range(9):            markup = markups[col]            preemptives = get_preemptive(markup)            markup = reduce_markup(markup, preemptives)            markups[col] = markup        markups = list(map(list, zip(*markups)))         for r_s, c_s in itertools.product(range(3), range(3)):            markup = [r[c_s * 3:c_s * 3 + 3] for r in markups[r_s * 3:r_s * 3 + 3]]            markup = list(itertools.chain(*markup))            preemptives = get_preemptive(markup)            markup = reduce_markup(markup, preemptives)            for i in range(3):                markups[r_s * 3 + i][c_s * 3: c_s * 3 + 3] = markup[i * 3:i * 3 + 3]        empty_row, empty_col = next_empty(grid)        if empty_row is None:        return(grid)    for guess in markups[empty_row][empty_col]:                if check_conditions(grid, empty_row, empty_col, guess):            grid[empty_row][empty_col] = guess            if crook(grid):                return(grid)                grid[empty_row][empty_col] = 0            return Falsedef validateSolution(sudoku):    ## To check if it is a valid solution:        ## If any cell is empty:    if any([0 in row for row in sudoku]):        return(False)        for n in range(1,10):        for row in sudoku:            if n not in row:                return(False)                        for col in range(9):                if n not in [r[col] for r in sudoku]:                    return(False)                            ## In fact, if row and column-wise conditions are met, then subgrid condition is automatically met.         ## But we want to check it explicitly.        for r_start, c_start in itertools.product(range(3),range(3)):            if not any([n not in row[c_start * 3: c_start * 3 + 3] for row in grid[r_start * 3: r_start * 3 + 3]]):                return(False)                return(True)\n","dateCreated":"2022-04-09T23:35:04+09:00","dateModified":"2021-07-09T21:32:31+09:00","datePublished":"2022-04-09T23:35:04+09:00","description":"","headline":"Sudoku: A systemic approach to Sudoku - Part 2","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"},"publisher":{"@type":"Organization","name":"Michael Hur","sameAs":[],"image":"https://www.gravatar.com/avatar/e07c234b1bdc4490874a9182a531f9ba","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/e07c234b1bdc4490874a9182a531f9ba"}},"url":"http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/","keywords":"Python, Sudoku, Crook, Algorithm"}</script>
    <meta name="description" content="Rule of Sudoku Every square has to contain a single number  Only the numbers between 1 and 9 (inclusive) can be used  Each 3×3 subgrid can only contain each number from 1 to 9 once  Each column can on">
<meta property="og:type" content="blog">
<meta property="og:title" content="Sudoku: A systemic approach to Sudoku - Part 2">
<meta property="og:url" content="http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/index.html">
<meta property="og:site_name" content="Michael&#39;s Dev Story">
<meta property="og:description" content="Rule of Sudoku Every square has to contain a single number  Only the numbers between 1 and 9 (inclusive) can be used  Each 3×3 subgrid can only contain each number from 1 to 9 once  Each column can on">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/markup.png">
<meta property="og:image" content="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/preemptive_odd.png">
<meta property="og:image" content="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_imcomp_real.png">
<meta property="og:image" content="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_markup.png">
<meta property="og:image" content="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_markup.png">
<meta property="article:published_time" content="2022-04-09T14:35:04.930Z">
<meta property="article:modified_time" content="2021-07-09T12:32:31.000Z">
<meta property="article:author" content="Michael Hur">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Sudoku">
<meta property="article:tag" content="Crook">
<meta property="article:tag" content="Algorithm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/markup.png">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-tt5otrcfnyzi0refn9zrhtfrt4xlibymuuibvd4oaixntnzpzpm8wmtxdjom.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3BRJMLJ1CX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3BRJMLJ1CX');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Michael&#39;s Dev Story
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/michaelhur"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:jhhur716@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Sudoku: A systemic approach to Sudoku - Part 2
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-04-09T23:35:04+09:00">
	
		    Apr 09, 2022
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="Rule-of-Sudoku"><a href="#Rule-of-Sudoku" class="headerlink" title="Rule of Sudoku"></a>Rule of Sudoku</h2><ul>
<li><p>Every square has to contain a single number</p>
</li>
<li><p>Only the numbers between 1 and 9 (inclusive) can be used</p>
</li>
<li><p>Each 3×3 subgrid can only contain each number from 1 to 9 once</p>
</li>
<li><p>Each column can only contain each number from 1 to 9 once</p>
</li>
<li><p>Each row can only contain each number from 1 to 9 once</p>
</li>
</ul>
<h2 id="Approaches"><a href="#Approaches" class="headerlink" title="Approaches"></a>Approaches</h2><p>Given an unsolved sudoku puzzle, our approach is to</p>
<h3 id="2-Crook’s-algorithm"><a href="#2-Crook’s-algorithm" class="headerlink" title="2. Crook’s algorithm"></a>2. <a target="_blank" rel="noopener" href="https://www.ams.org/notices/200904/rtx090400460p.pdf">Crook’s algorithm</a></h3><p>Crook’s algorithm is basically is how a human being would solve the problem. There are a few terms that we need to define in order to put them together</p>
<ol>
<li><code>Mark-up</code>: a <code>mark-up</code> of a cell is a list of all the possible given the numbers that are already in the grid. For example, the <code>mark-up</code> of the very first cell of the grid below is <code>5</code> and <code>7</code>. We can use mark-up instead of trying each number between 1 and 9. This means a fewer cheks to do and shorter computing time.</li>
</ol>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/markup.png" alt="An example of mark-up"></p>
<ol start="2">
<li><p><code>Preemptive set</code> is a list of <code>k</code> numbers (2 &lt;&#x3D; k &lt;&#x3D; 8), each between 1 and 9, with the property that only those k numbers can fill k cells. For example, <code>mark-ups</code> in cell (1,1) and (2,1) for a preemptive set of (5, 7). Those <code>2</code> cells can be filled in by only (5, 7) which is a set of <code>2</code> numbers. </p>
<p> This might sound ambiguous, but is very useful when eliminating candidates from the mark-up of a cell in the same column (or row or 3x3 subgrid). Since numbers 5 and 7 must each occupy one of cells (1, 1) and (2, 1), 5 cannot be in the cell (8,1) in the same column. 5 is then eliminated from the <code>mark-up</code> of the cell (8,1), leaving it with the only one candidate 4. i.e. the cell (8,1) must be filled with 4.</p>
</li>
</ol>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/preemptive_odd.png" alt="An example of preemptive set"></p>
<h4 id="Crook’s-Algorithm"><a href="#Crook’s-Algorithm" class="headerlink" title="Crook’s Algorithm"></a>Crook’s Algorithm</h4><ol>
<li><p>Mark up all the empty cells.</p>
<p> a) If the mark-up consists of only one number, fill in the cell with the number.</p>
<p> b) Remove such number from the mark-up of the cells in the same row, column and subgrid.</p>
</li>
<li><p>Find preemptive sets.</p>
<p> a) Whenever a preemptive set is found, cross out the numbers in the preemptive set from the <code>mark-up</code> of the cells in the same row, column or subgrid.</p>
<p> b) Repeat until you find no more preemtive set or rule of Sudoku is violated.</p>
</li>
<li><p>If the sudoku is not solved by then, or rule of sudoku has not been violated, apply backtracking method from here, but only using the numbers the mark-up instead of all the numbers from 1 to 9.</p>
</li>
</ol>
<h4 id="Helper-Functions"><a href="#Helper-Functions" class="headerlink" title="Helper Functions"></a>Helper Functions</h4><p>We will build helper functions that check rules of sudoku.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## This puts above two rule checkers together into one function.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_conditions</span>(<span class="params">grid, row, col, n</span>):   </span><br><span class="line">    <span class="comment">## check_conditions: list of lists, int, int, int -&gt; boolean</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> grid[row]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([r[col] == n <span class="keyword">for</span> r <span class="keyword">in</span> grid]):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    r_start = (row // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    c_start = (col // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r, c <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        <span class="keyword">if</span> grid[r_start + r][c_start + c] == n:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">next_empty</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## next_empty(): listof lists -&gt; int, int</span></span><br><span class="line">    <span class="comment">## next_empty() is a helper function that searches for the next empty cell in the given sudoku puzzle</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> grid:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> row:</span><br><span class="line">            <span class="keyword">return</span> (grid.index(row), row.index(<span class="number">0</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">validateSolution</span>(<span class="params">sudoku</span>):</span><br><span class="line">    <span class="comment">## To check if it is a valid solution:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## If any cell is empty:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([<span class="number">0</span> <span class="keyword">in</span> row <span class="keyword">for</span> row <span class="keyword">in</span> sudoku]):</span><br><span class="line">        <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> sudoku:</span><br><span class="line">            <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> row:</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> [r[col] <span class="keyword">for</span> r <span class="keyword">in</span> sudoku]:</span><br><span class="line">                    <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">        <span class="comment">## In fact, if row and column-wise conditions are met, then subgrid condition is automatically met. </span></span><br><span class="line">        <span class="comment">## But we want to check it explicitly.</span></span><br><span class="line">        <span class="keyword">for</span> r_start, c_start <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>([n <span class="keyword">not</span> <span class="keyword">in</span> row[c_start * <span class="number">3</span>: c_start * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> row <span class="keyword">in</span> grid[r_start * <span class="number">3</span>: r_start * <span class="number">3</span> + <span class="number">3</span>]]):</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span>(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Crook’s-Algorithm-1"><a href="#Crook’s-Algorithm-1" class="headerlink" title="Crook’s Algorithm"></a>Crook’s Algorithm</h2><ol>
<li><p>Mark up all the empty cells.</p>
<p> a) If the mark-up consists of only one number, fill in the cell with the number.</p>
<p> b) Remove such number from the mark-up of the cells in the same row, column and subgrid.</p>
</li>
<li><p>Find preemptive sets.</p>
<p> a) Whenever a preemptive set is found, cross out the numbers in the preemptive set from the <code>mark-up</code> of the cells in the same row, column or subgrid.</p>
<p> b) Repeat until you find no more preemtive set or rule of Sudoku is violated.</p>
</li>
<li><p>If the sudoku is not solved by then, or rule of sudoku has not been violated, pick any empty cell. Make a guess (i.e. pick a number from the markups), then repeat steps 1 and 2 until you can reduce it as much as possible. Repeat step 3 until the rule is violated or the puzzle is solved.</p>
</li>
</ol>
<h4 id="Breakdowns"><a href="#Breakdowns" class="headerlink" title="Breakdowns:"></a>Breakdowns:</h4><h4 id="Mark-up"><a href="#Mark-up" class="headerlink" title="Mark up"></a>Mark up</h4><ol>
<li>Define a function that finds the mark-up of an empty cell.</li>
</ol>
<ul>
<li><p>check_conditions() function come in handy.</p>
</li>
<li><p>Hunch is that we find the row and column index of an empty cell using the next_empty() function, then use check_conditions() function to find mark-ups.</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br></pre></td></tr></table></figure>

<p>Or more easier to read:</p>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_imcomp_real.png" alt="An example of mark-up"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Working with one empty cell. The last cell in the first row.</span></span><br><span class="line">r1, c1 = <span class="number">0</span>, <span class="number">8</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools </span><br><span class="line"></span><br><span class="line">markup = []</span><br><span class="line"><span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> check_conditions(grid, r1, c1, candidate):</span><br><span class="line">        markup.append(candidate)</span><br><span class="line">    </span><br><span class="line">markup</span><br></pre></td></tr></table></figure>




<pre><code>[1, 3, 4]
</code></pre>
<p>In order to apply this We cannot use next_empty() without making some manipulation to the function, since there is no insertion at this point. So we will simply loop through each and every cell for the time being</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">markup_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    r = [[]]*<span class="number">9</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        markup = []</span><br><span class="line">        <span class="keyword">if</span> grid[row][col] != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">if</span> check_conditions(grid, row, col, candidate):</span><br><span class="line">                markup.append(candidate)</span><br><span class="line"></span><br><span class="line">        r[col] = markup</span><br><span class="line"></span><br><span class="line">    markup_list.append(r)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">markup_list</span><br></pre></td></tr></table></figure>




<pre><code>[[[], [], [], [], [3, 4], [1, 3, 4], [], [], [1, 3, 4]],
 [[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]],
 [[],
  [4, 7],
  [],
  [1, 2, 4, 9],
  [2, 3, 4, 9],
  [1, 2, 3, 4, 9],
  [4, 5, 9],
  [1, 3, 4, 9],
  [1, 3, 4, 5, 7]],
 [[1, 3, 4, 9],
  [1, 4, 8],
  [],
  [2, 4, 9],
  [],
  [2, 4, 9],
  [2, 4, 9],
  [1, 3, 4, 8, 9],
  []],
 [[1, 4, 6, 9],
  [1, 4, 6],
  [2, 9],
  [],
  [],
  [],
  [2, 4, 5, 9],
  [1, 4, 9],
  [1, 4, 5]],
 [[], [4, 8], [2, 3, 8, 9], [2, 4, 9], [], [], [], [3, 4, 8, 9], [3, 4, 8]],
 [[3, 6, 7], [6, 7, 8], [3, 8], [], [2, 3, 4, 7], [2, 3, 4], [], [4, 8], []],
 [[1, 7, 9], [], [8, 9], [], [4, 7, 9], [1, 4, 9], [], [], [4, 8]],
 [[1, 3, 9], [], [], [1, 9], [3, 9], [], [], [], []]]
</code></pre>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_markup.png"></p>
<p>Putting it into a function so that we can use it repeatedly.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_markup</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## get_markup(): listof listof int -&gt; listof listof int</span></span><br><span class="line">    <span class="comment">## This helper function returns a list of list of integers</span></span><br><span class="line">    <span class="comment">## where each list of integer is a markup of a corresponding cell </span></span><br><span class="line">    markup_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        r = [[]]*<span class="number">9</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = []</span><br><span class="line">            <span class="keyword">if</span> grid[row][col] != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> check_conditions(grid, row, col, candidate):</span><br><span class="line">                    markup.append(candidate)</span><br><span class="line"></span><br><span class="line">            r[col] = markup</span><br><span class="line"></span><br><span class="line">        markup_list.append(r)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span>(markup_list)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">markups = get_markup(grid)</span><br><span class="line">markups</span><br></pre></td></tr></table></figure>




<pre><code>[[[], [], [], [], [3, 4], [1, 3, 4], [], [], [1, 3, 4]],
 [[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]],
 [[],
  [4, 7],
  [],
  [1, 2, 4, 9],
  [2, 3, 4, 9],
  [1, 2, 3, 4, 9],
  [4, 5, 9],
  [1, 3, 4, 9],
  [1, 3, 4, 5, 7]],
 [[1, 3, 4, 9],
  [1, 4, 8],
  [],
  [2, 4, 9],
  [],
  [2, 4, 9],
  [2, 4, 9],
  [1, 3, 4, 8, 9],
  []],
 [[1, 4, 6, 9],
  [1, 4, 6],
  [2, 9],
  [],
  [],
  [],
  [2, 4, 5, 9],
  [1, 4, 9],
  [1, 4, 5]],
 [[], [4, 8], [2, 3, 8, 9], [2, 4, 9], [], [], [], [3, 4, 8, 9], [3, 4, 8]],
 [[3, 6, 7], [6, 7, 8], [3, 8], [], [2, 3, 4, 7], [2, 3, 4], [], [4, 8], []],
 [[1, 7, 9], [], [8, 9], [], [4, 7, 9], [1, 4, 9], [], [], [4, 8]],
 [[1, 3, 9], [], [], [1, 9], [3, 9], [], [], [], []]]
</code></pre>
<h4 id="Preemptive-set"><a href="#Preemptive-set" class="headerlink" title="Preemptive set"></a>Preemptive set</h4><p>Here, we will work with the markups to find the preemptive set. First we will try to find the preemptive set then find a way to find smaller set by eliminating.</p>
<p>For a list of m numbers to be preemptive, it must have m different cells with the same m markups.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## r2 is the second row of the grid</span></span><br><span class="line">r2 =   [[<span class="number">4</span>, <span class="number">7</span>], [], [], [], [], [], [<span class="number">4</span>, <span class="number">9</span>], [], [<span class="number">4</span>, <span class="number">7</span>]]</span><br><span class="line">r2</span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">preemptive_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> r2:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(m) != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m) == r2.count(m):</span><br><span class="line">            <span class="keyword">if</span> m <span class="keyword">not</span> <span class="keyword">in</span> preemptive_list:</span><br><span class="line">                preemptive_list.append(m)</span><br><span class="line">                </span><br><span class="line">preemptive_list            </span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7]]
</code></pre>
<p>Now we want to eliminate these numbers from other cell’s markups.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> preemptive_list:</span><br><span class="line">    <span class="built_in">print</span>([[y <span class="keyword">for</span> y <span class="keyword">in</span> x <span class="keyword">if</span> (y <span class="keyword">not</span> <span class="keyword">in</span> p)] <span class="keyword">if</span> x != p <span class="keyword">else</span> p <span class="keyword">for</span> x <span class="keyword">in</span> r2])</span><br></pre></td></tr></table></figure>

<pre><code>[[4, 7], [], [], [], [], [], [9], [], [4, 7]]
</code></pre>
<p>This can be easily manipulated to be applied to column-wise and subgrid-wise operation.</p>
<p>Putting it altogether so that we find preemptive sets for each column, row and subgrid, then eliminate markups using those preemptive sets.</p>
<p>We will first define functions to do so:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_preemptive</span>(<span class="params">listofMarkup</span>):</span><br><span class="line">    </span><br><span class="line">    preemptive_list = []</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> listofMarkup:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(m) == listofMarkup.count(m):</span><br><span class="line">                <span class="keyword">if</span> m <span class="keyword">not</span> <span class="keyword">in</span> preemptive_list:</span><br><span class="line">                    preemptive_list.append(m)</span><br><span class="line">    <span class="keyword">return</span>(preemptive_list)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_preemptive(get_markup(grid)[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reduce_markup</span>(<span class="params">listofMarkup, preemptive_list</span>):</span><br><span class="line">    <span class="comment"># compute row-, col- or subgrid-wise</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(preemptive_list) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span>(listofMarkup)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> preemptive_list:</span><br><span class="line">        <span class="keyword">return</span>([[m <span class="keyword">for</span> m <span class="keyword">in</span> l <span class="keyword">if</span> (m <span class="keyword">not</span> <span class="keyword">in</span> p)] <span class="keyword">if</span> l != p <span class="keyword">else</span> p <span class="keyword">for</span> l <span class="keyword">in</span> listofMarkup])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reduce_markup(get_markup(grid)[<span class="number">1</span>], get_preemptive(get_markup(grid)[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7], [], [], [], [], [], [9], [], [4, 7]]
</code></pre>
<h4 id="Now-putting-it-all-together…"><a href="#Now-putting-it-all-together…" class="headerlink" title="Now putting it all together…"></a>Now putting it all together…</h4><ol>
<li><p>We will find markups for all empty cells in the grid</p>
</li>
<li><p>Find preemptive sets for all rows, columns and subgrids, then eliminate candidates from markups</p>
</li>
<li><p>If only the markup consists of only one candidate, fill in the cell with such number, then remove this number from all markups in the same row, column and subgrid.</p>
</li>
<li><p>Repeat until we cannot reduce the markups</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    markup = markups[row]</span><br><span class="line">    preemptives = get_preemptive(markup)</span><br><span class="line">    markup = reduce_markup(markup, preemptives)</span><br></pre></td></tr></table></figure>

<p>This line will eliminate markups using preemptive sets in each row. Column can be done in the same manner. We will use <code>list(map(list, zip(*l)))</code>, where <code>l</code> is a list of our interest, to transpose the list. Will do the same as we do with the row-wise operation, then transpose back.</p>
<p>For the subgrid, we will use list index to extract the 3x3 subgrid, find preemptive sets and reduce markups, row by row but with only 3 markups per row.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">    markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">    markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">    preemptives = get_preemptive(markup)</span><br><span class="line">    markup = reduce_markup(markup, preemptives)</span><br><span class="line">    <span class="comment">#print(markup)</span></span><br><span class="line">    <span class="comment">#markup_subgrid = [markup[k*3:k*3+3] for k in range(3)]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<p>Putting it all together. This block of codes will keep reducing until we cannot reduce markups. Note that we will enter the markup into the grid if there is only one candidate for the cell. We will define a function that will find a cell with only one candidate, in the similar manner as the next_empty() function in the previous part.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">markups = get_markup(grid)</span><br><span class="line">[[<span class="built_in">len</span>(m) <span class="keyword">for</span> m <span class="keyword">in</span> listofm] <span class="keyword">for</span> listofm <span class="keyword">in</span> markups]</span><br></pre></td></tr></table></figure>




<pre><code>[[0, 0, 0, 0, 2, 3, 0, 0, 3],
 [3, 0, 0, 0, 0, 0, 2, 0, 3],
 [0, 4, 0, 4, 4, 5, 3, 4, 5],
 [5, 4, 0, 3, 0, 3, 3, 5, 0],
 [4, 3, 2, 0, 0, 0, 4, 3, 3],
 [0, 3, 4, 3, 0, 0, 0, 4, 3],
 [4, 4, 2, 0, 4, 3, 0, 2, 0],
 [4, 0, 2, 0, 3, 3, 0, 0, 2],
 [3, 0, 0, 2, 2, 0, 0, 0, 0]]
</code></pre>
<p>This line gives the length (or the number of) of markups in each cell. 0 implies the cell that is already filled in.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line">markups = get_markup(grid)</span><br><span class="line">previous_markups = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_definite</span>(<span class="params">markups</span>):</span><br><span class="line">    markup_len = [[<span class="built_in">len</span>(m) <span class="keyword">for</span> m <span class="keyword">in</span> listofm] <span class="keyword">for</span> listofm <span class="keyword">in</span> markups]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> markup_len:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> <span class="keyword">in</span> row:</span><br><span class="line">            <span class="keyword">return</span> (markup_len.index(row), row.index(<span class="number">1</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> markups != previous_markups:</span><br><span class="line">    </span><br><span class="line">    previous_markups = markups</span><br><span class="line">    </span><br><span class="line">    def_row, def_col = next_definite(markups)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> def_row <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        grid[def_row][def_col] = markups[def_row][def_col][<span class="number">0</span>]</span><br><span class="line">        markups = get_markup(grid)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        markup = markups[row]</span><br><span class="line">        preemptives = get_preemptive(markup)</span><br><span class="line">        markup = reduce_markup(markup, preemptives)</span><br><span class="line">        markups[row] = markup</span><br><span class="line">    </span><br><span class="line">    markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups)))</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        markup = markups[col]</span><br><span class="line">        preemptives = get_preemptive(markup)</span><br><span class="line">        markup = reduce_markup(markup, preemptives)</span><br><span class="line">        markups[col] = markup</span><br><span class="line">    markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups))) </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">        markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">        preemptives = get_preemptive(markup)</span><br><span class="line">        markup = reduce_markup(markup, preemptives)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<p>Now we have reached the step where the markup can no longer be reduced and we do not have solution yet. We will make a guess on the first empty cell available, then repeat the above step. To make this easier, we will make the above block of codes function.</p>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_markup.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">crook</span>(<span class="params">grid</span>):</span><br><span class="line">    </span><br><span class="line">    markups = get_markup(grid)</span><br><span class="line">    previous_markups = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> markups != previous_markups:</span><br><span class="line"></span><br><span class="line">        previous_markups = markups</span><br><span class="line"></span><br><span class="line"><span class="comment">#         def_row, def_col = next_definite(markups)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         if def_row is not None:</span></span><br><span class="line"><span class="comment">#             grid[def_row][def_col] = markups[def_row][def_col][0]</span></span><br><span class="line"><span class="comment">#             markups = get_markup(grid)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[row]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[row] = markup</span><br><span class="line"></span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups)))</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[col]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[col] = markup</span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups))) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">            markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">                markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br><span class="line">    </span><br><span class="line">    empty_row, empty_col = next_empty(grid)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> empty_row <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span>(grid)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> guess <span class="keyword">in</span> markups[empty_row][empty_col]:</span><br><span class="line">        <span class="comment">#print(&quot;Guess in (&#123;r&#125;,&#123;c&#125;):&#123;n&#125;&quot;.format(r=empty_row, c=empty_col, n=guess))</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> check_conditions(grid, empty_row, empty_col, guess):</span><br><span class="line">            grid[empty_row][empty_col] = guess</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> crook(grid):</span><br><span class="line">                <span class="keyword">return</span>(grid)</span><br><span class="line">        </span><br><span class="line">        grid[empty_row][empty_col] = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grid_sol = crook(grid)</span><br><span class="line">grid_sol</span><br></pre></td></tr></table></figure>




<pre><code>[[2, 9, 5, 7, 4, 3, 8, 6, 1],
 [4, 3, 1, 8, 6, 5, 9, 2, 7],
 [8, 7, 6, 1, 9, 2, 5, 4, 3],
 [3, 8, 7, 4, 5, 9, 2, 1, 6],
 [6, 1, 2, 3, 8, 7, 4, 9, 5],
 [5, 4, 9, 2, 1, 6, 7, 3, 8],
 [7, 6, 3, 5, 2, 4, 1, 8, 9],
 [9, 2, 8, 6, 7, 1, 3, 5, 4],
 [1, 5, 4, 9, 3, 8, 6, 7, 2]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validateSolution(grid_sol)</span><br></pre></td></tr></table></figure>




<pre><code>True
</code></pre>
<p>Voila! We solved the sudoku puzzle with the Crook’s algorithm.</p>
<p>Below is the code put together so that you can try it yourselves!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check_conditions</span>(<span class="params">grid, row, col, n</span>):   </span><br><span class="line">    <span class="comment">## check_conditions: list of lists, int, int, int -&gt; boolean</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> grid[row]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([r[col] == n <span class="keyword">for</span> r <span class="keyword">in</span> grid]):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    r_start = (row // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    c_start = (col // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r, c <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        <span class="keyword">if</span> grid[r_start + r][c_start + c] == n:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_markup</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## get_markup(): listof listof int -&gt; listof listof int</span></span><br><span class="line">    <span class="comment">## This helper function returns a list of list of integers</span></span><br><span class="line">    <span class="comment">## where each list of integer is a markup of a corresponding cell </span></span><br><span class="line">    markup_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        r = [[]]*<span class="number">9</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = []</span><br><span class="line">            <span class="keyword">if</span> grid[row][col] != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> check_conditions(grid, row, col, candidate):</span><br><span class="line">                    markup.append(candidate)</span><br><span class="line"></span><br><span class="line">            r[col] = markup</span><br><span class="line"></span><br><span class="line">        markup_list.append(r)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span>(markup_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_preemptive</span>(<span class="params">listofMarkup</span>):</span><br><span class="line">    </span><br><span class="line">    preemptive_list = []</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> listofMarkup:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(m) == listofMarkup.count(m):</span><br><span class="line">                <span class="keyword">if</span> m <span class="keyword">not</span> <span class="keyword">in</span> preemptive_list:</span><br><span class="line">                    preemptive_list.append(m)</span><br><span class="line">    <span class="keyword">return</span>(preemptive_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reduce_markup</span>(<span class="params">listofMarkup, preemptive_list</span>):</span><br><span class="line">    <span class="comment"># compute row-, col- or subgrid-wise</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(preemptive_list) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span>(listofMarkup)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> preemptive_list:</span><br><span class="line">        <span class="keyword">return</span>([[m <span class="keyword">for</span> m <span class="keyword">in</span> l <span class="keyword">if</span> (m <span class="keyword">not</span> <span class="keyword">in</span> p)] <span class="keyword">if</span> l != p <span class="keyword">else</span> p <span class="keyword">for</span> l <span class="keyword">in</span> listofMarkup])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_empty</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## next_empty(): listof lists -&gt; int, int</span></span><br><span class="line">    <span class="comment">## next_empty() is a helper function that searches for the next empty cell in the given sudoku puzzle</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> grid:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> row:</span><br><span class="line">            <span class="keyword">return</span> (grid.index(row), row.index(<span class="number">0</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crook</span>(<span class="params">grid</span>):</span><br><span class="line">    </span><br><span class="line">    markups = get_markup(grid)</span><br><span class="line">    previous_markups = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> markups != previous_markups:</span><br><span class="line"></span><br><span class="line">        previous_markups = markups</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[row]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[row] = markup</span><br><span class="line"></span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups)))</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[col]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[col] = markup</span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups))) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">            markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">                markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br><span class="line">    </span><br><span class="line">    empty_row, empty_col = next_empty(grid)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> empty_row <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span>(grid)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> guess <span class="keyword">in</span> markups[empty_row][empty_col]:</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> check_conditions(grid, empty_row, empty_col, guess):</span><br><span class="line">            grid[empty_row][empty_col] = guess</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> crook(grid):</span><br><span class="line">                <span class="keyword">return</span>(grid)</span><br><span class="line">        </span><br><span class="line">        grid[empty_row][empty_col] = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validateSolution</span>(<span class="params">sudoku</span>):</span><br><span class="line">    <span class="comment">## To check if it is a valid solution:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## If any cell is empty:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([<span class="number">0</span> <span class="keyword">in</span> row <span class="keyword">for</span> row <span class="keyword">in</span> sudoku]):</span><br><span class="line">        <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> sudoku:</span><br><span class="line">            <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> row:</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> [r[col] <span class="keyword">for</span> r <span class="keyword">in</span> sudoku]:</span><br><span class="line">                    <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">        <span class="comment">## In fact, if row and column-wise conditions are met, then subgrid condition is automatically met. </span></span><br><span class="line">        <span class="comment">## But we want to check it explicitly.</span></span><br><span class="line">        <span class="keyword">for</span> r_start, c_start <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>([n <span class="keyword">not</span> <span class="keyword">in</span> row[c_start * <span class="number">3</span>: c_start * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> row <span class="keyword">in</span> grid[r_start * <span class="number">3</span>: r_start * <span class="number">3</span> + <span class="number">3</span>]]):</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span>(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Algorithm/" rel="tag">Algorithm</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Crook/" rel="tag">Crook</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Python/" rel="tag">Python</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Sudoku/" rel="tag">Sudoku</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/09/2021-06-22-Sudoku%20-%20Part%20-1/"
                    data-tooltip="Sudoku: A systemic approach to Sudoku - Part 1"
                    aria-label="PREVIOUS: Sudoku: A systemic approach to Sudoku - Part 1"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 Michael Hur. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/09/2021-06-22-Sudoku%20-%20Part%20-1/"
                    data-tooltip="Sudoku: A systemic approach to Sudoku - Part 1"
                    aria-label="PREVIOUS: Sudoku: A systemic approach to Sudoku - Part 1"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Michael Hur</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Seoul, Korea
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="/assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-02-Blogging-with-github/"
                            aria-label=": Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기"
                        >
                            <h3 class="media-heading">Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                            aria-label=": PyMLB: Exploring MLB Data using Python"
                        >
                            <h3 class="media-heading">PyMLB: Exploring MLB Data using Python</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-11-Strike%20Zone/"
                            aria-label=": PyMLB to plot Pitch f/x data"
                        >
                            <h3 class="media-heading">PyMLB to plot Pitch f/x data</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-22-Sudoku%20-%20Part%20-1/"
                            aria-label=": Sudoku: A systemic approach to Sudoku - Part 1"
                        >
                            <h3 class="media-heading">Sudoku: A systemic approach to Sudoku - Part 1</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                            aria-label=": Sudoku: A systemic approach to Sudoku - Part 2"
                        >
                            <h3 class="media-heading">Sudoku: A systemic approach to Sudoku - Part 2</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="no post found"
                data-message-one="1 post found"
                data-message-other="{n} posts found">
                5 posts found
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-zoi9cv3fxbuk68sxg0xkjhah3klemljfujipeswdtomoblnegzlm06beywp6.min.js"></script>

<!--SCRIPTS END-->


    



    
<script src="/assets/js/moment-with-locales.js"></script>

    
<script src="/assets/js/algoliasearch.js"></script>

    <script>
      var algoliaClient = algoliasearch('9VB9TCFAHT', 'd97cd513ecc908497c4bdbde1c715f36');
      var algoliaIndex = algoliaClient.initIndex('my-hexo-blog');
    </script>


    </body>
</html>
