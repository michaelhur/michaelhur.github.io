
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Michael&#39;s Dev Story">
    <title>Tag: Plotly - Michael&#39;s Dev Story</title>
    <meta name="author" content="Michael Hur">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Michael&#39;s Dev Story">
<meta property="og:url" content="http://michaelhur.github.io/tags/Plotly/index.html">
<meta property="og:site_name" content="Michael&#39;s Dev Story">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Michael Hur">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-tt5otrcfnyzi0refn9zrhtfrt4xlibymuuibvd4oaixntnzpzpm8wmtxdjom.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3BRJMLJ1CX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3BRJMLJ1CX');
    </script>


    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Michael&#39;s Dev Story
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/michaelhur"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:jhhur716@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2022/04/09/2021-06-11-Strike%20Zone/"
                            aria-label=": PyMLB to plot Pitch f/x data"
                        >
                            PyMLB to plot Pitch f/x data
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-04-09T23:35:04+09:00">
	
		    Apr 09, 2022
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>This time we will look at what the strike zone looks like for a Korean Pitcher “Ryu Hyun-Jin.” </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PyMLB <span class="keyword">import</span> *</span><br></pre></td></tr></table></figure>

<h4 id="1-Pull-schedule-data"><a href="#1-Pull-schedule-data" class="headerlink" title="1. Pull schedule data"></a>1. Pull schedule data</h4><p>First we need to pull all the game ID for this particular pitcher for this season. Using <a href="https://michaelhur.github.io/PyMLB/">get_schedule() function we coded last time</a>, we will extract schedule data. </p>
<p>Unfortunately, we can only pull the schedule data at the team level. So we will extract all the game his team “Toronto Blue Jays” has played this season, then filter the games he has played.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bluejays_schedule = get_schedule(teamId = <span class="number">141</span>, startDate = <span class="string">&quot;2021-04-01&quot;</span>, endDate = yesterday)</span><br></pre></td></tr></table></figure>

<p>The output looks like this:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">next</span>(<span class="built_in">iter</span>(bluejays_schedule.values()))</span><br></pre></td></tr></table></figure>

<pre><code>[&#123;&#39;gamePk&#39;: 634642,
  &#39;home&#39;: &#123;&#39;ID&#39;: 147, &#39;name&#39;: &#39;New York Yankees&#39;&#125;,
  &#39;away&#39;: &#123;&#39;ID&#39;: 141, &#39;name&#39;: &#39;Toronto Blue Jays&#39;&#125;&#125;]
</code></pre>
<p>From this schedule dictionary, we will extract only the <code>gamePk</code> which will be used to pull pitch f&#x2F;x data for that particular game.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gamePks = [v[<span class="number">0</span>][<span class="string">&#x27;gamePk&#x27;</span>] <span class="keyword">for</span> k, v <span class="keyword">in</span> bluejays_schedule.items()]</span><br></pre></td></tr></table></figure>

<p>And the first 10 gamePk’s look like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gamePks[<span class="number">0</span>:<span class="number">10</span>]</span><br></pre></td></tr></table></figure>

<pre><code>[634642,
 634644,
 634607,
 634612,
 634635,
 634583,
 634545,
 634512,
 632227,
 632208]
</code></pre>
<h4 id="2-Pitch-fx-data"><a href="#2-Pitch-fx-data" class="headerlink" title="2. Pitch fx data"></a>2. Pitch fx data</h4><p>Next step is to extract pitch fx data for each game. We will loop through each of gamePks we obtains above. Again, using get_pitchfx() function we coded last time:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pitchfx = get_pitchfx(<span class="number">634642</span>)</span><br></pre></td></tr></table></figure>

<p>As a reminder, get_pitchfx() returns pitch f&#x2F;x data as a dictionary object, where each key on the top level corresponds to each “at bat”. The second tier dictionary stores the pitch fx data we want, so we will extact them systematically.</p>
<p>In order to make analysis easier (or coding for the analysis easier), we will convert this dictionary object to a dataframe object. We remove the non-pitchfx data from the dictionary:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pitches = &#123;k:v <span class="keyword">for</span> k, v <span class="keyword">in</span> pitchfx.items() <span class="keyword">if</span> k != <span class="string">&quot;home_umpire&quot;</span>&#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">next</span>(<span class="built_in">iter</span>(pitches.values()))</span><br></pre></td></tr></table></figure>

<pre><code>&#123;&#39;inning&#39;: 1,
 &#39;home&#39;: &#39;home&#39;,
 &#39;pitcher&#39;: &#123;&#39;id&#39;: 543037,
  &#39;fullName&#39;: &#39;Gerrit Cole&#39;,
  &#39;link&#39;: &#39;/api/v1/people/543037&#39;&#125;,
 &#39;batter&#39;: &#123;&#39;id&#39;: 543760,
  &#39;fullName&#39;: &#39;Marcus Semien&#39;,
  &#39;link&#39;: &#39;/api/v1/people/543760&#39;&#125;,
 &#39;pitchHand&#39;: &#39;R&#39;,
 &#39;batSide&#39;: &#39;R&#39;,
 &#39;pitchData&#39;: [&#123;&#39;call&#39;: &#39;ball&#39;,
   &#39;sz_top&#39;: 3.25,
   &#39;sz_bottom&#39;: 1.53,
   &#39;x&#39;: -0.5,
   &#39;z&#39;: 3.54&#125;]&#125;
</code></pre>
<p>We will carry (almost) all the data in the dictionary into the dataframe object.</p>
<ol>
<li>Define an empty dataframe</li>
<li>Loop through each at bat</li>
<li>Loop through each pitch</li>
<li>Concatenate one row in each loop</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment">## Since we are carrying all the information to the dataframe object,</span></span><br><span class="line"><span class="comment">## we will label all the columns as is.</span></span><br><span class="line">pd_index = [<span class="string">&quot;atbat&quot;</span>, <span class="string">&quot;pitchCount&quot;</span>, <span class="string">&quot;inning&quot;</span>, <span class="string">&quot;home&quot;</span>, <span class="string">&quot;pitcher&quot;</span>, <span class="string">&quot;pitcherId&quot;</span>, <span class="string">&quot;pitchHand&quot;</span>,</span><br><span class="line">             <span class="string">&quot;batter&quot;</span>, <span class="string">&quot;batterId&quot;</span>, <span class="string">&quot;batSide&quot;</span>, <span class="string">&quot;sz_top&quot;</span>, <span class="string">&quot;sz_bottom&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;call&quot;</span>, <span class="string">&quot;actual&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">## Create an empty dataframe with only the column names defined.</span></span><br><span class="line">new_df = pd.DataFrame(index = pd_index).T</span><br><span class="line"></span><br><span class="line"><span class="comment">## For loop through each at bat</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> pitches.items():</span><br><span class="line">    atbat = k</span><br><span class="line">    inning = v[<span class="string">&#x27;inning&#x27;</span>]</span><br><span class="line">    home = v[<span class="string">&#x27;home&#x27;</span>]</span><br><span class="line">    pitcher = v[<span class="string">&#x27;pitcher&#x27;</span>][<span class="string">&#x27;fullName&#x27;</span>]</span><br><span class="line">    pitcherId = v[<span class="string">&#x27;pitcher&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">    pitchHand = v[<span class="string">&#x27;pitchHand&#x27;</span>]</span><br><span class="line">    batter = v[<span class="string">&#x27;batter&#x27;</span>][<span class="string">&#x27;fullName&#x27;</span>]</span><br><span class="line">    batterId = v[<span class="string">&#x27;batter&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">    batSide = v[<span class="string">&#x27;batSide&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    pitchCount = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## For loop through each pitch</span></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> v[<span class="string">&#x27;pitchData&#x27;</span>]:</span><br><span class="line">        pitchCount += <span class="number">1</span></span><br><span class="line">        sz_top = p[<span class="string">&#x27;sz_top&#x27;</span>]</span><br><span class="line">        sz_bottom = p[<span class="string">&#x27;sz_bottom&#x27;</span>]</span><br><span class="line">        x = p[<span class="string">&#x27;x&#x27;</span>]</span><br><span class="line">        z = p[<span class="string">&#x27;z&#x27;</span>]</span><br><span class="line">        call = p[<span class="string">&#x27;call&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment">## Given the actual strike zone, determine whether the call made was strike or not</span></span><br><span class="line">        actual = <span class="string">&quot;strike&quot;</span> <span class="keyword">if</span> (sz_bottom &lt;= z &lt;= sz_top) <span class="keyword">and</span> (-<span class="number">0.71</span> &lt; x &lt; <span class="number">0.71</span>) <span class="keyword">else</span> <span class="string">&quot;ball&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">## Each pitch will be turned into a single-row dataframe</span></span><br><span class="line">        new_row = [atbat, pitchCount, inning, home, pitcher, pitcherId, pitchHand,</span><br><span class="line">                   batter, batterId, batSide, sz_top, sz_bottom, x, z, call, actual]</span><br><span class="line"></span><br><span class="line">        new_df1 = pd.DataFrame(new_row, index = pd_index).T</span><br><span class="line">        </span><br><span class="line">        <span class="comment">## This newly defined data frame will be concatenated to the already existing dataframe.</span></span><br><span class="line">        new_df = pd.concat([new_df,new_df1])</span><br><span class="line"></span><br><span class="line"><span class="comment">## New column definitions:</span></span><br><span class="line"><span class="comment">## &#x27;calledRight&#x27;: Each entry is a boolean, whether the call made is correct or not</span></span><br><span class="line">new_df[<span class="string">&#x27;calledRight&#x27;</span>] = (new_df[<span class="string">&#x27;call&#x27;</span>] == new_df[<span class="string">&#x27;actual&#x27;</span>])</span><br><span class="line">new_df[<span class="string">&#x27;umpire&#x27;</span>] = pitchfx[<span class="string">&#x27;home_umpire&#x27;</span>]</span><br><span class="line">new_df.reset_index(drop = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>We will put this into the function so that we can apply it to any other pitch fx data.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">to_df</span>(<span class="params">pitchfx</span>):</span><br><span class="line">    </span><br><span class="line">    pitches = &#123;k:v <span class="keyword">for</span> k, v <span class="keyword">in</span> pitchfx.items() <span class="keyword">if</span> k != <span class="string">&quot;home_umpire&quot;</span>&#125;    </span><br><span class="line"></span><br><span class="line">    pd_index = [<span class="string">&quot;atbat&quot;</span>, <span class="string">&quot;pitchCount&quot;</span>, <span class="string">&quot;inning&quot;</span>, <span class="string">&quot;home&quot;</span>, <span class="string">&quot;pitcher&quot;</span>, <span class="string">&quot;pitcherId&quot;</span>, <span class="string">&quot;pitchHand&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;batter&quot;</span>, <span class="string">&quot;batterId&quot;</span>, <span class="string">&quot;batSide&quot;</span>, <span class="string">&quot;sz_top&quot;</span>, <span class="string">&quot;sz_bottom&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;call&quot;</span>, <span class="string">&quot;actual&quot;</span>]</span><br><span class="line"></span><br><span class="line">    new_df = pd.DataFrame(index = pd_index).T</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> pitches.items():</span><br><span class="line">        atbat = k</span><br><span class="line">        inning = v[<span class="string">&#x27;inning&#x27;</span>]</span><br><span class="line">        home = v[<span class="string">&#x27;home&#x27;</span>]</span><br><span class="line">        pitcher = v[<span class="string">&#x27;pitcher&#x27;</span>][<span class="string">&#x27;fullName&#x27;</span>]</span><br><span class="line">        pitcherId = v[<span class="string">&#x27;pitcher&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        pitchHand = v[<span class="string">&#x27;pitchHand&#x27;</span>]</span><br><span class="line">        batter = v[<span class="string">&#x27;batter&#x27;</span>][<span class="string">&#x27;fullName&#x27;</span>]</span><br><span class="line">        batterId = v[<span class="string">&#x27;batter&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        batSide = v[<span class="string">&#x27;batSide&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        pitchCount = <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> v[<span class="string">&#x27;pitchData&#x27;</span>]:</span><br><span class="line">            pitchCount += <span class="number">1</span></span><br><span class="line">            sz_top = p[<span class="string">&#x27;sz_top&#x27;</span>]</span><br><span class="line">            sz_bottom = p[<span class="string">&#x27;sz_bottom&#x27;</span>]</span><br><span class="line">            x = p[<span class="string">&#x27;x&#x27;</span>]</span><br><span class="line">            z = p[<span class="string">&#x27;z&#x27;</span>]</span><br><span class="line">            call = p[<span class="string">&#x27;call&#x27;</span>]</span><br><span class="line"></span><br><span class="line">            actual = <span class="string">&quot;strike&quot;</span> <span class="keyword">if</span> (sz_bottom &lt;= z &lt;= sz_top) <span class="keyword">and</span> (-<span class="number">0.71</span> &lt; x &lt; <span class="number">0.71</span>) <span class="keyword">else</span> <span class="string">&quot;ball&quot;</span></span><br><span class="line"></span><br><span class="line">            new_row = [atbat, pitchCount, inning, home, pitcher, pitcherId, pitchHand,</span><br><span class="line">                       batter, batterId, batSide, sz_top, sz_bottom, x, z, call, actual]</span><br><span class="line"></span><br><span class="line">            new_df1 = pd.DataFrame(new_row, index = pd_index).T</span><br><span class="line">            new_df = pd.concat([new_df,new_df1])</span><br><span class="line"></span><br><span class="line">    new_df[<span class="string">&#x27;calledRight&#x27;</span>] = (new_df[<span class="string">&#x27;call&#x27;</span>] == new_df[<span class="string">&#x27;actual&#x27;</span>])</span><br><span class="line">    new_df[<span class="string">&#x27;umpire&#x27;</span>] = pitchfx[<span class="string">&#x27;home_umpire&#x27;</span>]</span><br><span class="line">    new_df.reset_index(drop = <span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span>(new_df)</span><br></pre></td></tr></table></figure>

<p>Using one of the gamePk, we will try plot pitch fx data. Once succeed, we will apply to all gamePks.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_634642 = to_df(pitchfx)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line"></span><br><span class="line"><span class="comment">## Plot scatter plot, grouped by strike and ball calls</span></span><br><span class="line">fig = px.scatter(df_634642, x=<span class="string">&quot;x&quot;</span>, y=<span class="string">&quot;z&quot;</span>, color=<span class="string">&quot;call&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Draw a rectangle that represents the strike zone</span></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line">fig.update_traces(marker=<span class="built_in">dict</span>(size=<span class="number">12</span>,</span><br><span class="line">                              line=<span class="built_in">dict</span>(width=<span class="number">2</span>,</span><br><span class="line">                                        color=<span class="string">&#x27;DarkSlateGrey&#x27;</span>)),</span><br><span class="line">                  selector=<span class="built_in">dict</span>(mode=<span class="string">&#x27;markers&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://michaelhur.github.io/images/20210611/1.png"></p>
<p>In this game, we see quite a number of strikes that were placed well outside the strike zone. On the contrary, we see relatively fewer <code>ball</code> called even if it passed through the strike zone.</p>
<p>We want to see how they differ depending on home&#x2F;away.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">fig = px.scatter(df_634642, x=<span class="string">&quot;x&quot;</span>, y=<span class="string">&quot;z&quot;</span>, color=<span class="string">&quot;call&quot;</span>, facet_col=<span class="string">&quot;home&quot;</span>,</span><br><span class="line">          labels=&#123;<span class="string">&quot;call&quot;</span>: <span class="string">&quot;Call&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x2&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.update_traces(marker=<span class="built_in">dict</span>(size=<span class="number">12</span>,</span><br><span class="line">                              line=<span class="built_in">dict</span>(width=<span class="number">2</span>,</span><br><span class="line">                                        color=<span class="string">&#x27;DarkSlateGrey&#x27;</span>)),</span><br><span class="line">                  selector=<span class="built_in">dict</span>(mode=<span class="string">&#x27;markers&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://michaelhur.github.io/images/20210611/2.png"></p>
<p>Interestingly, of all pitches placed in the lower right corner of the strike zone, there were more pitches called <code>ball</code> for the away team’s pitcher than the home team’s pitcher.</p>
<p>Now we look at all the strike calls and see where they landed at.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df_634642[df_634642.call == <span class="string">&quot;strike&quot;</span>][<span class="string">&#x27;calledRight&#x27;</span>].value_counts(normalize = <span class="literal">True</span>)*<span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_634642[df_634642.call == <span class="string">&quot;strike&quot;</span>].groupby([<span class="string">&#x27;home&#x27;</span>])[<span class="string">&#x27;calledRight&#x27;</span>].value_counts(normalize = <span class="literal">True</span>)*<span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<pre><code>True     52.941176
False    47.058824
Name: calledRight, dtype: float64


home  calledRight
away  True           53.703704
      False          46.296296
home  True           52.083333
      False          47.916667
Name: calledRight, dtype: float64
</code></pre>
<p>Interestingly of all <code>strike</code> calls in this game, only 52.9% of the calls were called correctly. In other words, 47.1% of all strike calls should have been called <code>ball</code>.</p>
<p>On the bright side, the proportion of correctly called strikes to incorrectly called strikes are almost the same at the home&#x2F;away level. So the umpire was not biased againt the away team.</p>
<p>Visual inspection shows:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">fig = px.scatter(df_634642[df_634642.call == <span class="string">&quot;strike&quot;</span>], x=<span class="string">&quot;x&quot;</span>, y=<span class="string">&quot;z&quot;</span>, color=<span class="string">&quot;calledRight&quot;</span>, facet_col=<span class="string">&quot;home&quot;</span>,</span><br><span class="line">          labels=&#123;<span class="string">&quot;call&quot;</span>: <span class="string">&quot;Call&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x2&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.update_traces(marker=<span class="built_in">dict</span>(size=<span class="number">12</span>,</span><br><span class="line">                              line=<span class="built_in">dict</span>(width=<span class="number">2</span>,</span><br><span class="line">                                        color=<span class="string">&#x27;DarkSlateGrey&#x27;</span>)),</span><br><span class="line">                  selector=<span class="built_in">dict</span>(mode=<span class="string">&#x27;markers&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://michaelhur.github.io/images/20210611/3.png"></p>
<ul>
<li><p>Looking at the home team pitcher’s strike zone, we see only 3 strike calls that are labelled “incorrectly called” that lie in the strike zone. This is due to the process of fixing the strike zone for all batters. </p>
</li>
<li><p>For the home pitchers, most of the incorrectly called strikes are placed on the bottom right corner of the plot. On the other hand, for the away pitchers, it were mostly <code>wide pitches</code> that were called strike incorrectly.</p>
</li>
</ul>
<p>Now look at all the <code>ball</code> calls.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df_634642[df_634642.call == <span class="string">&quot;ball&quot;</span>][<span class="string">&#x27;calledRight&#x27;</span>].value_counts(normalize = <span class="literal">True</span>)*<span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_634642[df_634642.call == <span class="string">&quot;ball&quot;</span>].groupby([<span class="string">&#x27;home&#x27;</span>])[<span class="string">&#x27;calledRight&#x27;</span>].value_counts(normalize = <span class="literal">True</span>)*<span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<pre><code>True     97.744361
False     2.255639
Name: calledRight, dtype: float64


home  calledRight
away  True           98.717949
      False           1.282051
home  True           96.363636
      False           3.636364
Name: calledRight, dtype: float64
</code></pre>
<p>Umpires are doing better job on this side of the call. 97% of all <code>balls</code> are called correctly. My guess is that umpires are more conservative on calling <code>balls</code> than <code>strikes</code>.</p>
<p>Enough with the opening game of the season, let’s get back in the game. Follow the same process for all of Ryu’s game.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pd_index = [<span class="string">&quot;atbat&quot;</span>, <span class="string">&quot;pitchCount&quot;</span>, <span class="string">&quot;inning&quot;</span>, <span class="string">&quot;home&quot;</span>, <span class="string">&quot;pitcher&quot;</span>, <span class="string">&quot;pitcherId&quot;</span>, <span class="string">&quot;pitchHand&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;batter&quot;</span>, <span class="string">&quot;batterId&quot;</span>, <span class="string">&quot;batSide&quot;</span>, <span class="string">&quot;sz_top&quot;</span>, <span class="string">&quot;sz_bottom&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;call&quot;</span>, <span class="string">&quot;actual&quot;</span>]</span><br><span class="line"></span><br><span class="line">ryu_df = pd.DataFrame(index = pd_index).T</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> gamePk <span class="keyword">in</span> tqdm(gamePks):</span><br><span class="line">    <span class="comment">#print(gamePk)</span></span><br><span class="line">    df_new = to_df(get_pitchfx(gamePk))</span><br><span class="line">    ryu_df = pd.concat([ryu_df,df_new])</span><br><span class="line"></span><br><span class="line">ryu_df = ryu_df[ryu_df.pitcherId == <span class="number">547943</span>]</span><br><span class="line">ryu_df = ryu_df.reset_index(drop = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<pre><code>100%|██████████| 66/66 [01:14&lt;00:00,  1.13s/it]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fig = px.scatter(ryu_df, x=<span class="string">&quot;x&quot;</span>, y=<span class="string">&quot;z&quot;</span>, color=<span class="string">&quot;call&quot;</span>)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line">fig.update_traces(marker=<span class="built_in">dict</span>(size=<span class="number">12</span>,</span><br><span class="line">                              line=<span class="built_in">dict</span>(width=<span class="number">2</span>,</span><br><span class="line">                                        color=<span class="string">&#x27;DarkSlateGrey&#x27;</span>)),</span><br><span class="line">                  selector=<span class="built_in">dict</span>(mode=<span class="string">&#x27;markers&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>


<p><img src="https://michaelhur.github.io/images/20210611/4.png"></p>
<p>Looking at only the <code>strike</code> calls:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fig = px.scatter(ryu_df[ryu_df[<span class="string">&#x27;call&#x27;</span>] == <span class="string">&#x27;strike&#x27;</span>], x=<span class="string">&quot;x&quot;</span>, y=<span class="string">&quot;z&quot;</span>)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line">fig.update_traces(marker=<span class="built_in">dict</span>(size=<span class="number">12</span>,</span><br><span class="line">                              line=<span class="built_in">dict</span>(width=<span class="number">2</span>,</span><br><span class="line">                                        color=<span class="string">&#x27;DarkSlateGrey&#x27;</span>)),</span><br><span class="line">                  selector=<span class="built_in">dict</span>(mode=<span class="string">&#x27;markers&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://michaelhur.github.io/images/20210611/5.png"></p>
<p>Visual inspection implies that Ryu’s strike zone is wider to both sides. However, when we also look at all the <code>ball</code> calls, we see:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">fig = px.scatter(ryu_df, x=<span class="string">&quot;x&quot;</span>, y=<span class="string">&quot;z&quot;</span>, color=<span class="string">&quot;calledRight&quot;</span>, facet_col=<span class="string">&quot;call&quot;</span>,</span><br><span class="line">          labels=&#123;<span class="string">&quot;calledRight&quot;</span>: <span class="string">&quot;called Right&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.add_shape(<span class="built_in">type</span>=<span class="string">&quot;rect&quot;</span>,</span><br><span class="line">    xref = <span class="string">&quot;x2&quot;</span>, yref = <span class="string">&quot;y&quot;</span>,</span><br><span class="line">    x0 = -<span class="number">0.71</span>, y0 = <span class="number">1.5</span>,</span><br><span class="line">    x1 = <span class="number">0.71</span>, y1 = <span class="number">3.5</span>,</span><br><span class="line">    line=<span class="built_in">dict</span>(</span><br><span class="line">        color=<span class="string">&quot;RoyalBlue&quot;</span>,</span><br><span class="line">        width=<span class="number">3</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.update_traces(marker=<span class="built_in">dict</span>(size=<span class="number">12</span>,</span><br><span class="line">                              line=<span class="built_in">dict</span>(width=<span class="number">2</span>,</span><br><span class="line">                                        color=<span class="string">&#x27;DarkSlateGrey&#x27;</span>)),</span><br><span class="line">                  selector=<span class="built_in">dict</span>(mode=<span class="string">&#x27;markers&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://michaelhur.github.io/images/20210611/6.png"></p>
<p>Almost all <code>ball</code> calls are called correctly, and there are so many <code>ball</code> calls landed at the same region as those <code>strike</code> calls to the sides of the strike zone. This implies that he has pitches they moves horizontally, leading to <code>swinging strikes</code>.</p>
<p>These are some of the very few insights one can derive from the visualization of pitch fx data. One can inspect this at the umpire level and see how they perform.</p>
<h4 id="Try-it-yourself"><a href="#Try-it-yourself" class="headerlink" title="Try it yourself!"></a>Try it yourself!</h4><p>Using the following code, you can try plotting them yourself.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PyMLB <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_df</span>(<span class="params">pitchfx</span>):</span><br><span class="line">    </span><br><span class="line">    pitches = &#123;k:v <span class="keyword">for</span> k, v <span class="keyword">in</span> pitchfx.items() <span class="keyword">if</span> k != <span class="string">&quot;home_umpire&quot;</span>&#125;    </span><br><span class="line"></span><br><span class="line">    pd_index = [<span class="string">&quot;atbat&quot;</span>, <span class="string">&quot;pitchCount&quot;</span>, <span class="string">&quot;inning&quot;</span>, <span class="string">&quot;home&quot;</span>, <span class="string">&quot;pitcher&quot;</span>, <span class="string">&quot;pitcherId&quot;</span>, <span class="string">&quot;pitchHand&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;batter&quot;</span>, <span class="string">&quot;batterId&quot;</span>, <span class="string">&quot;batSide&quot;</span>, <span class="string">&quot;sz_top&quot;</span>, <span class="string">&quot;sz_bottom&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;call&quot;</span>, <span class="string">&quot;actual&quot;</span>]</span><br><span class="line"></span><br><span class="line">    new_df = pd.DataFrame(index = pd_index).T</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> pitches.items():</span><br><span class="line">        atbat = k</span><br><span class="line">        inning = v[<span class="string">&#x27;inning&#x27;</span>]</span><br><span class="line">        home = v[<span class="string">&#x27;home&#x27;</span>]</span><br><span class="line">        pitcher = v[<span class="string">&#x27;pitcher&#x27;</span>][<span class="string">&#x27;fullName&#x27;</span>]</span><br><span class="line">        pitcherId = v[<span class="string">&#x27;pitcher&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        pitchHand = v[<span class="string">&#x27;pitchHand&#x27;</span>]</span><br><span class="line">        batter = v[<span class="string">&#x27;batter&#x27;</span>][<span class="string">&#x27;fullName&#x27;</span>]</span><br><span class="line">        batterId = v[<span class="string">&#x27;batter&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">        batSide = v[<span class="string">&#x27;batSide&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        pitchCount = <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> v[<span class="string">&#x27;pitchData&#x27;</span>]:</span><br><span class="line">            pitchCount += <span class="number">1</span></span><br><span class="line">            sz_top = p[<span class="string">&#x27;sz_top&#x27;</span>]</span><br><span class="line">            sz_bottom = p[<span class="string">&#x27;sz_bottom&#x27;</span>]</span><br><span class="line">            x = p[<span class="string">&#x27;x&#x27;</span>]</span><br><span class="line">            z = p[<span class="string">&#x27;z&#x27;</span>]</span><br><span class="line">            call = p[<span class="string">&#x27;call&#x27;</span>]</span><br><span class="line"></span><br><span class="line">            actual = <span class="string">&quot;strike&quot;</span> <span class="keyword">if</span> (sz_bottom &lt;= z &lt;= sz_top) <span class="keyword">and</span> (-<span class="number">0.71</span> &lt; x &lt; <span class="number">0.71</span>) <span class="keyword">else</span> <span class="string">&quot;ball&quot;</span></span><br><span class="line"></span><br><span class="line">            new_row = [atbat, pitchCount, inning, home, pitcher, pitcherId, pitchHand,</span><br><span class="line">                       batter, batterId, batSide, sz_top, sz_bottom, x, z, call, actual]</span><br><span class="line"></span><br><span class="line">            new_df1 = pd.DataFrame(new_row, index = pd_index).T</span><br><span class="line">            new_df = pd.concat([new_df,new_df1])</span><br><span class="line"></span><br><span class="line">    new_df[<span class="string">&#x27;calledRight&#x27;</span>] = (new_df[<span class="string">&#x27;call&#x27;</span>] == new_df[<span class="string">&#x27;actual&#x27;</span>])</span><br><span class="line">    new_df[<span class="string">&#x27;umpire&#x27;</span>] = pitchfx[<span class="string">&#x27;home_umpire&#x27;</span>]</span><br><span class="line">    new_df.reset_index(drop = <span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span>(new_df)</span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2022/04/09/2021-06-11-Strike%20Zone/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 Michael Hur. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Michael Hur</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Seoul, Korea
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="/assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-02-Blogging-with-github/"
                            aria-label=": Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기"
                        >
                            <h3 class="media-heading">Github, Jekyll과 Minimal Mistakes를 이용하여 블로그 만들기</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-02-PyMLB/"
                            aria-label=": PyMLB: Exploring MLB Data using Python"
                        >
                            <h3 class="media-heading">PyMLB: Exploring MLB Data using Python</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-04-MongoDB/"
                            aria-label=": NoSQL and SQL - Part 1"
                        >
                            <h3 class="media-heading">NoSQL and SQL - Part 1</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-11-Strike%20Zone/"
                            aria-label=": PyMLB to plot Pitch f/x data"
                        >
                            <h3 class="media-heading">PyMLB to plot Pitch f/x data</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-22-Sudoku%20-%20Part%20-1/"
                            aria-label=": Sudoku: A systemic approach to Sudoku - Part 1"
                        >
                            <h3 class="media-heading">Sudoku: A systemic approach to Sudoku - Part 1</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="http://michaelhur.github.io/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                            aria-label=": Sudoku: A systemic approach to Sudoku - Part 2"
                        >
                            <h3 class="media-heading">Sudoku: A systemic approach to Sudoku - Part 2</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 9, 2022
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="no post found"
                data-message-one="1 post found"
                data-message-other="{n} posts found">
                6 posts found
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-zoi9cv3fxbuk68sxg0xkjhah3klemljfujipeswdtomoblnegzlm06beywp6.min.js"></script>

<!--SCRIPTS END-->




    
<script src="/assets/js/moment-with-locales.js"></script>

    
<script src="/assets/js/algoliasearch.js"></script>

    <script>
      var algoliaClient = algoliasearch('9VB9TCFAHT', 'd97cd513ecc908497c4bdbde1c715f36');
      var algoliaIndex = algoliaClient.initIndex('my-hexo-blog');
    </script>


    </body>
</html>
