
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Michael&#39;s Development Story">
    <title>Tag: Sudoku - Michael&#39;s Development Story</title>
    <meta name="author" content="Michael Hur">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Michael&#39;s Development Story">
<meta property="og:url" content="http://michaelhur.github.io/tags/Sudoku/index.html">
<meta property="og:site_name" content="Michael&#39;s Development Story">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Michael Hur">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-tt5otrcfnyzi0refn9zrhtfrt4xlibymuuibvd4oaixntnzpzpm8wmtxdjom.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Michael&#39;s Development Story
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/michaelhur"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:jhhur716@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2022/04/09/2021-06-22-Sudoku%20-%20Part%20-1/"
                            aria-label=": Sudoku: A systemic approach to Sudoku - Part 1"
                        >
                            Sudoku: A systemic approach to Sudoku - Part 1
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-04-09T23:35:04+09:00">
	
		    Apr 09, 2022
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="Rule-of-Sudoku"><a href="#Rule-of-Sudoku" class="headerlink" title="Rule of Sudoku"></a>Rule of Sudoku</h2><ul>
<li><p>Every square has to contain a single number</p>
</li>
<li><p>Only the numbers between 1 and 9 (inclusive) can be used</p>
</li>
<li><p>Each 3×3 subgrid can only contain each number from 1 to 9 once</p>
</li>
<li><p>Each column can only contain each number from 1 to 9 once</p>
</li>
<li><p>Each row can only contain each number from 1 to 9 once</p>
</li>
</ul>
<h2 id="Approaches"><a href="#Approaches" class="headerlink" title="Approaches"></a>Approaches</h2><p>Given an unsolved sudoku puzzle, our approach is to</p>
<h3 id="1-Backtracking-i-e-Brute-force"><a href="#1-Backtracking-i-e-Brute-force" class="headerlink" title="1. Backtracking. i.e. Brute-force"></a>1. Backtracking. i.e. Brute-force</h3><ul>
<li><p>Starting from the top left cell in the puzzle, we go through every unfilled cell from left to right, then top to bottom. </p>
</li>
<li><p>Try filling the square with a number between 1 and 9, following the rules stated above. </p>
</li>
<li><p>Continue the process until either </p>
<p>  a) we reach a cell where no possible numeric input exist. go back to the previous supposedly unfilled square, trying with a different number starting there. (i.e. “Backtrack”)</p>
<p>  b) we reach the last unfilled cell with only one possible input exist. i.e. Sudoku solved!</p>
</li>
</ul>
<h5 id="Aside"><a href="#Aside" class="headerlink" title="Aside:"></a>Aside:</h5><p>Why list over numpy array in this project?</p>
<p>Numpy arrays are known to be faster than lists. Typically, it is true. But our approach involes assigning new values to entries in the list (or array). In this case, list operation tends to be faster than array operation. </p>
<p>Checking it out:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line"></span><br><span class="line">array_test = np.random.randint(low = <span class="number">1</span>, high = <span class="number">9</span>, size=(<span class="number">9</span>,<span class="number">9</span>))</span><br><span class="line">list_test = array_test.tolist()</span><br><span class="line"></span><br><span class="line">%timeit <span class="keyword">for</span> row, col <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">9</span>),<span class="built_in">range</span>(<span class="number">9</span>)): array_test[row,col] = <span class="number">10</span></span><br><span class="line">%timeit <span class="keyword">for</span> row, col <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">9</span>),<span class="built_in">range</span>(<span class="number">9</span>)): list_test[row][col] = <span class="number">10</span></span><br></pre></td></tr></table></figure>

<pre><code>6.1 µs ± 38.5 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
3.2 µs ± 21.7 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</code></pre>
<p>As you can see assignment is almost twice faster with list than with numpy arrays. We can add conditional statement within to further test.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%timeit <span class="keyword">for</span> row, col <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">9</span>),<span class="built_in">range</span>(<span class="number">9</span>)): array_test[row,col] = <span class="number">10</span> <span class="keyword">if</span> array_test[row,col] &gt; <span class="number">5</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">%timeit <span class="keyword">for</span> row, col <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">9</span>),<span class="built_in">range</span>(<span class="number">9</span>)): list_test[row][col] = <span class="number">10</span> <span class="keyword">if</span> list_test[row][col] &gt; <span class="number">5</span> <span class="keyword">else</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<pre><code>18.1 µs ± 178 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
5.52 µs ± 159 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</code></pre>
<p>With the conditional statement, the assignment is three times faster with list than numpy array.</p>
<h2 id="Backtracking-Algorithm"><a href="#Backtracking-Algorithm" class="headerlink" title="Backtracking Algorithm"></a>Backtracking Algorithm</h2><ol>
<li><p>Find an unfilled cell in the grid.</p>
</li>
<li><p>Enter 1 into the cell. Check if the insertion violates any rule of sudoku. </p>
<p> a) If it violates. Try inserting 2, 3, 4, … , 9 until the rule is not violated</p>
<p> b) If it does not violate, proceed to the next empty cell and enter 1, 2, ….</p>
</li>
<li><p>Repeat steps 1 and 2 until you reach the last cell in the grid, or no possible input is available for any empty cell.</p>
</li>
</ol>
<h4 id="Helper-Functions"><a href="#Helper-Functions" class="headerlink" title="Helper Functions"></a>Helper Functions</h4><p>We will build helper functions that check rules of sudoku.</p>
<p>We need to check if the guess we make already exists in the row, column and subgrid we are about to enter into</p>
<ol>
<li>Row-wise check</li>
</ol>
<p>A row-sie check is pretty simple. Each list within the grid represent a row, so we can do</p>
<p><code>n in row</code> to check if n (our guess) already exists in the row.</p>
<ol start="2">
<li>Column-wise check</li>
</ol>
<p>i-th column of the grid is each represented by the i-th element of each row. That is, we need to loop through each row to extract i-th element of the row, then compute to see if our guess is already in the column.</p>
<p><code>for row in grid:     if grid[row][i] == n:         return False</code></p>
<p>or more pythonically:</p>
<p><code>any([r[col] == n for r in grid])</code></p>
<p>will check if any of the i-th element of each row is equal to our guess, n.</p>
<ol start="3">
<li>Subgrid check</li>
</ol>
<p>Each subgrid is 3x3, with the (row, column) indices <code>[0:3] / [3:6] / [6:9]</code>. Since we only need to check the subgrid the cell belongs to, we will compute where to starting index is:</p>
<p><code>row_number // 3</code></p>
<p>will tell whether it is the first, second, or third subgrid vertically (or horizontally if we compute column-wise). Then we multiply it by 3 to find out the index in terms of grid row and column.</p>
<p><code>row_number // 3 * 3</code></p>
<p>This will be the starting index of the subgrid, then we add 3 (since it is 3x3 grid) to get the end index. To sum it up,</p>
<p><code>row_start = row_number // 3 * 3</code></p>
<p><code>row_end = row_start + 3</code></p>
<p>WOLG, <code>col_start = col_number // 3 * 3</code> and <code>col_end = col_start + 3</code>.</p>
<p>We will then loop through each of 9 cells within the subgrid to check if our guess is already in the subgrid.</p>
<p><code>for r in range(row_start, row_end):     for c in range(col_start, col_end):         if grid[r][c] == n:             return False</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_subgrid</span>(<span class="params">grid, row, col, n</span>):</span><br><span class="line">    <span class="comment">## check_subgrid: listof lists, int, int, int -&gt; boolean</span></span><br><span class="line">    <span class="comment">## This helper function checks if input &quot;n&quot; is in the 3x3 subgrid.</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## We need to find out which region the cell falls in. </span></span><br><span class="line">    r_start = (row // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    c_start = (col // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r, c <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        <span class="keyword">if</span> grid[r_start + r][c_start + c] == n:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check_row_and_col</span>(<span class="params">grid, row, col, n</span>):</span><br><span class="line">    <span class="comment">## check_row_and_col: list of lists, int, int, int -&gt; boolean</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## check row-wise</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> grid[row]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## check row-wise</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([r[col] == n <span class="keyword">for</span> r <span class="keyword">in</span> grid]):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<p>Instead of checking each condition separately, we will do it in one single function.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check_conditions</span>(<span class="params">grid, row, col, n</span>):   </span><br><span class="line">    <span class="comment">## check_conditions: list of lists, int, int, int -&gt; boolean</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> grid[row]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([r[col] == n <span class="keyword">for</span> r <span class="keyword">in</span> grid]):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    r_start = (row // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    c_start = (col // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r, c <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        <span class="keyword">if</span> grid[r_start + r][c_start + c] == n:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">validateSolution</span>(<span class="params">sudoku</span>):</span><br><span class="line">    <span class="comment">## To check if it is a valid solution:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## If any cell is empty:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([<span class="number">0</span> <span class="keyword">in</span> row <span class="keyword">for</span> row <span class="keyword">in</span> sudoku]):</span><br><span class="line">        <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> sudoku:</span><br><span class="line">            <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> row:</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> [r[col] <span class="keyword">for</span> r <span class="keyword">in</span> sudoku]:</span><br><span class="line">                    <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">        <span class="comment">## In fact, if row and column-wise conditions are met, then subgrid condition is automatically met. </span></span><br><span class="line">        <span class="comment">## But we want to check it explicitly.</span></span><br><span class="line">        <span class="keyword">for</span> r_start, c_start <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>([n <span class="keyword">not</span> <span class="keyword">in</span> row[c_start * <span class="number">3</span>: c_start * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> row <span class="keyword">in</span> grid[r_start * <span class="number">3</span>: r_start * <span class="number">3</span> + <span class="number">3</span>]]):</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span>(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Sudoku-Solver"><a href="#Sudoku-Solver" class="headerlink" title="Sudoku Solver"></a>Sudoku Solver</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">next_empty</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## next_empty(): listof lists -&gt; int, int</span></span><br><span class="line">    <span class="comment">## next_empty() is a helper function that searches for the next empty cell in the given sudoku puzzle</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> grid:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> row:</span><br><span class="line">            <span class="keyword">return</span> (grid.index(row), row.index(<span class="number">0</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_sudoku</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## solve_sudoku: listof lists -&gt; listof lists</span></span><br><span class="line">    <span class="comment">## solve_sudoku uses backtracking algorithm to solve the sudoku puzzle</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## 1. Find the next empty cell.    </span></span><br><span class="line">    row, col = next_empty(grid)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## If there is no empty cell, it means that all cells are filled. i.e. Sudoku Solved!</span></span><br><span class="line">    <span class="keyword">if</span> row <span class="keyword">is</span> <span class="literal">None</span>:  </span><br><span class="line">        <span class="keyword">return</span>(grid)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>): </span><br><span class="line">        <span class="comment">## 2. Enter 1, 2, 3, .... in the empty cell and check if it violates any rule.</span></span><br><span class="line">        <span class="keyword">if</span> check_conditions(grid, row, col, n):</span><br><span class="line">            </span><br><span class="line">            <span class="comment">## 3. If it does not violate the rules, then assign the value to the cell.</span></span><br><span class="line">            grid[row][col] = n</span><br><span class="line">            </span><br><span class="line">            <span class="comment">## 4. Proceed to the next cell recursively.</span></span><br><span class="line">            <span class="keyword">if</span> solve_sudoku(grid):</span><br><span class="line">                <span class="keyword">return</span>(grid)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">## If it violates any of the rules or does not have solution, empty the cell, </span></span><br><span class="line">        <span class="comment">## trying with different input</span></span><br><span class="line">        grid[row][col] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">## 6. No possible combination of inputs solve the sudoku. i.e. No solution.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grid = np.array([[<span class="number">5</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>],</span><br><span class="line">                 [<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">                 [<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">grid = grid.tolist()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solve_sudoku(grid)</span><br></pre></td></tr></table></figure>




<pre><code>[[5, 3, 4, 6, 7, 8, 9, 1, 2],
 [6, 7, 2, 1, 9, 5, 3, 4, 8],
 [1, 9, 8, 3, 4, 2, 5, 6, 7],
 [8, 5, 9, 7, 6, 1, 4, 2, 3],
 [4, 2, 6, 8, 5, 3, 7, 9, 1],
 [7, 1, 3, 9, 2, 4, 8, 5, 6],
 [9, 6, 1, 5, 3, 7, 2, 8, 4],
 [2, 8, 7, 4, 1, 9, 6, 3, 5],
 [3, 4, 5, 2, 8, 6, 1, 7, 9]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grid2 = np.array([[<span class="number">3</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">1</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">                 [<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">                 [<span class="number">9</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>],</span><br><span class="line">                 [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line">grid2 = grid2.tolist()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solve_sudoku(grid2)</span><br></pre></td></tr></table></figure>




<pre><code>[[3, 2, 9, 5, 6, 1, 4, 8, 7],
 [8, 1, 6, 4, 3, 7, 2, 5, 9],
 [7, 4, 5, 8, 9, 2, 1, 6, 3],
 [1, 9, 7, 3, 4, 8, 5, 2, 6],
 [6, 8, 2, 1, 5, 9, 3, 7, 4],
 [4, 5, 3, 7, 2, 6, 8, 9, 1],
 [2, 6, 1, 9, 8, 3, 7, 4, 5],
 [9, 3, 4, 2, 7, 5, 6, 1, 8],
 [5, 7, 8, 6, 1, 4, 9, 3, 2]]
</code></pre>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2022/04/09/2021-06-22-Sudoku%20-%20Part%20-1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/"
                            aria-label=": Sudoku: A systemic approach to Sudoku - Part 2"
                        >
                            Sudoku: A systemic approach to Sudoku - Part 2
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-04-09T23:35:04+09:00">
	
		    Apr 09, 2022
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="Rule-of-Sudoku"><a href="#Rule-of-Sudoku" class="headerlink" title="Rule of Sudoku"></a>Rule of Sudoku</h2><ul>
<li><p>Every square has to contain a single number</p>
</li>
<li><p>Only the numbers between 1 and 9 (inclusive) can be used</p>
</li>
<li><p>Each 3×3 subgrid can only contain each number from 1 to 9 once</p>
</li>
<li><p>Each column can only contain each number from 1 to 9 once</p>
</li>
<li><p>Each row can only contain each number from 1 to 9 once</p>
</li>
</ul>
<h2 id="Approaches"><a href="#Approaches" class="headerlink" title="Approaches"></a>Approaches</h2><p>Given an unsolved sudoku puzzle, our approach is to</p>
<h3 id="2-Crook’s-algorithm"><a href="#2-Crook’s-algorithm" class="headerlink" title="2. Crook’s algorithm"></a>2. <a target="_blank" rel="noopener" href="https://www.ams.org/notices/200904/rtx090400460p.pdf">Crook’s algorithm</a></h3><p>Crook’s algorithm is basically is how a human being would solve the problem. There are a few terms that we need to define in order to put them together</p>
<ol>
<li><code>Mark-up</code>: a <code>mark-up</code> of a cell is a list of all the possible given the numbers that are already in the grid. For example, the <code>mark-up</code> of the very first cell of the grid below is <code>5</code> and <code>7</code>. We can use mark-up instead of trying each number between 1 and 9. This means a fewer cheks to do and shorter computing time.</li>
</ol>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/markup.png" alt="An example of mark-up"></p>
<ol start="2">
<li><p><code>Preemptive set</code> is a list of <code>k</code> numbers (2 &lt;&#x3D; k &lt;&#x3D; 8), each between 1 and 9, with the property that only those k numbers can fill k cells. For example, <code>mark-ups</code> in cell (1,1) and (2,1) for a preemptive set of (5, 7). Those <code>2</code> cells can be filled in by only (5, 7) which is a set of <code>2</code> numbers. </p>
<p> This might sound ambiguous, but is very useful when eliminating candidates from the mark-up of a cell in the same column (or row or 3x3 subgrid). Since numbers 5 and 7 must each occupy one of cells (1, 1) and (2, 1), 5 cannot be in the cell (8,1) in the same column. 5 is then eliminated from the <code>mark-up</code> of the cell (8,1), leaving it with the only one candidate 4. i.e. the cell (8,1) must be filled with 4.</p>
</li>
</ol>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/preemptive_odd.png" alt="An example of preemptive set"></p>
<h4 id="Crook’s-Algorithm"><a href="#Crook’s-Algorithm" class="headerlink" title="Crook’s Algorithm"></a>Crook’s Algorithm</h4><ol>
<li><p>Mark up all the empty cells.</p>
<p> a) If the mark-up consists of only one number, fill in the cell with the number.</p>
<p> b) Remove such number from the mark-up of the cells in the same row, column and subgrid.</p>
</li>
<li><p>Find preemptive sets.</p>
<p> a) Whenever a preemptive set is found, cross out the numbers in the preemptive set from the <code>mark-up</code> of the cells in the same row, column or subgrid.</p>
<p> b) Repeat until you find no more preemtive set or rule of Sudoku is violated.</p>
</li>
<li><p>If the sudoku is not solved by then, or rule of sudoku has not been violated, apply backtracking method from here, but only using the numbers the mark-up instead of all the numbers from 1 to 9.</p>
</li>
</ol>
<h4 id="Helper-Functions"><a href="#Helper-Functions" class="headerlink" title="Helper Functions"></a>Helper Functions</h4><p>We will build helper functions that check rules of sudoku.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## This puts above two rule checkers together into one function.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_conditions</span>(<span class="params">grid, row, col, n</span>):   </span><br><span class="line">    <span class="comment">## check_conditions: list of lists, int, int, int -&gt; boolean</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> grid[row]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([r[col] == n <span class="keyword">for</span> r <span class="keyword">in</span> grid]):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    r_start = (row // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    c_start = (col // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r, c <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        <span class="keyword">if</span> grid[r_start + r][c_start + c] == n:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">next_empty</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## next_empty(): listof lists -&gt; int, int</span></span><br><span class="line">    <span class="comment">## next_empty() is a helper function that searches for the next empty cell in the given sudoku puzzle</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> grid:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> row:</span><br><span class="line">            <span class="keyword">return</span> (grid.index(row), row.index(<span class="number">0</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">validateSolution</span>(<span class="params">sudoku</span>):</span><br><span class="line">    <span class="comment">## To check if it is a valid solution:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## If any cell is empty:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([<span class="number">0</span> <span class="keyword">in</span> row <span class="keyword">for</span> row <span class="keyword">in</span> sudoku]):</span><br><span class="line">        <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> sudoku:</span><br><span class="line">            <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> row:</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> [r[col] <span class="keyword">for</span> r <span class="keyword">in</span> sudoku]:</span><br><span class="line">                    <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">        <span class="comment">## In fact, if row and column-wise conditions are met, then subgrid condition is automatically met. </span></span><br><span class="line">        <span class="comment">## But we want to check it explicitly.</span></span><br><span class="line">        <span class="keyword">for</span> r_start, c_start <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>([n <span class="keyword">not</span> <span class="keyword">in</span> row[c_start * <span class="number">3</span>: c_start * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> row <span class="keyword">in</span> grid[r_start * <span class="number">3</span>: r_start * <span class="number">3</span> + <span class="number">3</span>]]):</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span>(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Crook’s-Algorithm-1"><a href="#Crook’s-Algorithm-1" class="headerlink" title="Crook’s Algorithm"></a>Crook’s Algorithm</h2><ol>
<li><p>Mark up all the empty cells.</p>
<p> a) If the mark-up consists of only one number, fill in the cell with the number.</p>
<p> b) Remove such number from the mark-up of the cells in the same row, column and subgrid.</p>
</li>
<li><p>Find preemptive sets.</p>
<p> a) Whenever a preemptive set is found, cross out the numbers in the preemptive set from the <code>mark-up</code> of the cells in the same row, column or subgrid.</p>
<p> b) Repeat until you find no more preemtive set or rule of Sudoku is violated.</p>
</li>
<li><p>If the sudoku is not solved by then, or rule of sudoku has not been violated, pick any empty cell. Make a guess (i.e. pick a number from the markups), then repeat steps 1 and 2 until you can reduce it as much as possible. Repeat step 3 until the rule is violated or the puzzle is solved.</p>
</li>
</ol>
<h4 id="Breakdowns"><a href="#Breakdowns" class="headerlink" title="Breakdowns:"></a>Breakdowns:</h4><h4 id="Mark-up"><a href="#Mark-up" class="headerlink" title="Mark up"></a>Mark up</h4><ol>
<li>Define a function that finds the mark-up of an empty cell.</li>
</ol>
<ul>
<li><p>check_conditions() function come in handy.</p>
</li>
<li><p>Hunch is that we find the row and column index of an empty cell using the next_empty() function, then use check_conditions() function to find mark-ups.</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br></pre></td></tr></table></figure>

<p>Or more easier to read:</p>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_imcomp_real.png" alt="An example of mark-up"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Working with one empty cell. The last cell in the first row.</span></span><br><span class="line">r1, c1 = <span class="number">0</span>, <span class="number">8</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools </span><br><span class="line"></span><br><span class="line">markup = []</span><br><span class="line"><span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> check_conditions(grid, r1, c1, candidate):</span><br><span class="line">        markup.append(candidate)</span><br><span class="line">    </span><br><span class="line">markup</span><br></pre></td></tr></table></figure>




<pre><code>[1, 3, 4]
</code></pre>
<p>In order to apply this We cannot use next_empty() without making some manipulation to the function, since there is no insertion at this point. So we will simply loop through each and every cell for the time being</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">markup_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    r = [[]]*<span class="number">9</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        markup = []</span><br><span class="line">        <span class="keyword">if</span> grid[row][col] != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">if</span> check_conditions(grid, row, col, candidate):</span><br><span class="line">                markup.append(candidate)</span><br><span class="line"></span><br><span class="line">        r[col] = markup</span><br><span class="line"></span><br><span class="line">    markup_list.append(r)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">markup_list</span><br></pre></td></tr></table></figure>




<pre><code>[[[], [], [], [], [3, 4], [1, 3, 4], [], [], [1, 3, 4]],
 [[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]],
 [[],
  [4, 7],
  [],
  [1, 2, 4, 9],
  [2, 3, 4, 9],
  [1, 2, 3, 4, 9],
  [4, 5, 9],
  [1, 3, 4, 9],
  [1, 3, 4, 5, 7]],
 [[1, 3, 4, 9],
  [1, 4, 8],
  [],
  [2, 4, 9],
  [],
  [2, 4, 9],
  [2, 4, 9],
  [1, 3, 4, 8, 9],
  []],
 [[1, 4, 6, 9],
  [1, 4, 6],
  [2, 9],
  [],
  [],
  [],
  [2, 4, 5, 9],
  [1, 4, 9],
  [1, 4, 5]],
 [[], [4, 8], [2, 3, 8, 9], [2, 4, 9], [], [], [], [3, 4, 8, 9], [3, 4, 8]],
 [[3, 6, 7], [6, 7, 8], [3, 8], [], [2, 3, 4, 7], [2, 3, 4], [], [4, 8], []],
 [[1, 7, 9], [], [8, 9], [], [4, 7, 9], [1, 4, 9], [], [], [4, 8]],
 [[1, 3, 9], [], [], [1, 9], [3, 9], [], [], [], []]]
</code></pre>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_markup.png"></p>
<p>Putting it into a function so that we can use it repeatedly.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_markup</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## get_markup(): listof listof int -&gt; listof listof int</span></span><br><span class="line">    <span class="comment">## This helper function returns a list of list of integers</span></span><br><span class="line">    <span class="comment">## where each list of integer is a markup of a corresponding cell </span></span><br><span class="line">    markup_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        r = [[]]*<span class="number">9</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = []</span><br><span class="line">            <span class="keyword">if</span> grid[row][col] != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> check_conditions(grid, row, col, candidate):</span><br><span class="line">                    markup.append(candidate)</span><br><span class="line"></span><br><span class="line">            r[col] = markup</span><br><span class="line"></span><br><span class="line">        markup_list.append(r)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span>(markup_list)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">markups = get_markup(grid)</span><br><span class="line">markups</span><br></pre></td></tr></table></figure>




<pre><code>[[[], [], [], [], [3, 4], [1, 3, 4], [], [], [1, 3, 4]],
 [[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]],
 [[],
  [4, 7],
  [],
  [1, 2, 4, 9],
  [2, 3, 4, 9],
  [1, 2, 3, 4, 9],
  [4, 5, 9],
  [1, 3, 4, 9],
  [1, 3, 4, 5, 7]],
 [[1, 3, 4, 9],
  [1, 4, 8],
  [],
  [2, 4, 9],
  [],
  [2, 4, 9],
  [2, 4, 9],
  [1, 3, 4, 8, 9],
  []],
 [[1, 4, 6, 9],
  [1, 4, 6],
  [2, 9],
  [],
  [],
  [],
  [2, 4, 5, 9],
  [1, 4, 9],
  [1, 4, 5]],
 [[], [4, 8], [2, 3, 8, 9], [2, 4, 9], [], [], [], [3, 4, 8, 9], [3, 4, 8]],
 [[3, 6, 7], [6, 7, 8], [3, 8], [], [2, 3, 4, 7], [2, 3, 4], [], [4, 8], []],
 [[1, 7, 9], [], [8, 9], [], [4, 7, 9], [1, 4, 9], [], [], [4, 8]],
 [[1, 3, 9], [], [], [1, 9], [3, 9], [], [], [], []]]
</code></pre>
<h4 id="Preemptive-set"><a href="#Preemptive-set" class="headerlink" title="Preemptive set"></a>Preemptive set</h4><p>Here, we will work with the markups to find the preemptive set. First we will try to find the preemptive set then find a way to find smaller set by eliminating.</p>
<p>For a list of m numbers to be preemptive, it must have m different cells with the same m markups.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## r2 is the second row of the grid</span></span><br><span class="line">r2 =   [[<span class="number">4</span>, <span class="number">7</span>], [], [], [], [], [], [<span class="number">4</span>, <span class="number">9</span>], [], [<span class="number">4</span>, <span class="number">7</span>]]</span><br><span class="line">r2</span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7], [], [], [], [], [], [4, 9], [], [4, 7]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">preemptive_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> r2:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(m) != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m) == r2.count(m):</span><br><span class="line">            <span class="keyword">if</span> m <span class="keyword">not</span> <span class="keyword">in</span> preemptive_list:</span><br><span class="line">                preemptive_list.append(m)</span><br><span class="line">                </span><br><span class="line">preemptive_list            </span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7]]
</code></pre>
<p>Now we want to eliminate these numbers from other cell’s markups.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> preemptive_list:</span><br><span class="line">    <span class="built_in">print</span>([[y <span class="keyword">for</span> y <span class="keyword">in</span> x <span class="keyword">if</span> (y <span class="keyword">not</span> <span class="keyword">in</span> p)] <span class="keyword">if</span> x != p <span class="keyword">else</span> p <span class="keyword">for</span> x <span class="keyword">in</span> r2])</span><br></pre></td></tr></table></figure>

<pre><code>[[4, 7], [], [], [], [], [], [9], [], [4, 7]]
</code></pre>
<p>This can be easily manipulated to be applied to column-wise and subgrid-wise operation.</p>
<p>Putting it altogether so that we find preemptive sets for each column, row and subgrid, then eliminate markups using those preemptive sets.</p>
<p>We will first define functions to do so:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_preemptive</span>(<span class="params">listofMarkup</span>):</span><br><span class="line">    </span><br><span class="line">    preemptive_list = []</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> listofMarkup:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(m) == listofMarkup.count(m):</span><br><span class="line">                <span class="keyword">if</span> m <span class="keyword">not</span> <span class="keyword">in</span> preemptive_list:</span><br><span class="line">                    preemptive_list.append(m)</span><br><span class="line">    <span class="keyword">return</span>(preemptive_list)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_preemptive(get_markup(grid)[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reduce_markup</span>(<span class="params">listofMarkup, preemptive_list</span>):</span><br><span class="line">    <span class="comment"># compute row-, col- or subgrid-wise</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(preemptive_list) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span>(listofMarkup)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> preemptive_list:</span><br><span class="line">        <span class="keyword">return</span>([[m <span class="keyword">for</span> m <span class="keyword">in</span> l <span class="keyword">if</span> (m <span class="keyword">not</span> <span class="keyword">in</span> p)] <span class="keyword">if</span> l != p <span class="keyword">else</span> p <span class="keyword">for</span> l <span class="keyword">in</span> listofMarkup])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reduce_markup(get_markup(grid)[<span class="number">1</span>], get_preemptive(get_markup(grid)[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>




<pre><code>[[4, 7], [], [], [], [], [], [9], [], [4, 7]]
</code></pre>
<h4 id="Now-putting-it-all-together…"><a href="#Now-putting-it-all-together…" class="headerlink" title="Now putting it all together…"></a>Now putting it all together…</h4><ol>
<li><p>We will find markups for all empty cells in the grid</p>
</li>
<li><p>Find preemptive sets for all rows, columns and subgrids, then eliminate candidates from markups</p>
</li>
<li><p>If only the markup consists of only one candidate, fill in the cell with such number, then remove this number from all markups in the same row, column and subgrid.</p>
</li>
<li><p>Repeat until we cannot reduce the markups</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    markup = markups[row]</span><br><span class="line">    preemptives = get_preemptive(markup)</span><br><span class="line">    markup = reduce_markup(markup, preemptives)</span><br></pre></td></tr></table></figure>

<p>This line will eliminate markups using preemptive sets in each row. Column can be done in the same manner. We will use <code>list(map(list, zip(*l)))</code>, where <code>l</code> is a list of our interest, to transpose the list. Will do the same as we do with the row-wise operation, then transpose back.</p>
<p>For the subgrid, we will use list index to extract the 3x3 subgrid, find preemptive sets and reduce markups, row by row but with only 3 markups per row.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">    markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">    markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">    preemptives = get_preemptive(markup)</span><br><span class="line">    markup = reduce_markup(markup, preemptives)</span><br><span class="line">    <span class="comment">#print(markup)</span></span><br><span class="line">    <span class="comment">#markup_subgrid = [markup[k*3:k*3+3] for k in range(3)]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<p>Putting it all together. This block of codes will keep reducing until we cannot reduce markups. Note that we will enter the markup into the grid if there is only one candidate for the cell. We will define a function that will find a cell with only one candidate, in the similar manner as the next_empty() function in the previous part.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">markups = get_markup(grid)</span><br><span class="line">[[<span class="built_in">len</span>(m) <span class="keyword">for</span> m <span class="keyword">in</span> listofm] <span class="keyword">for</span> listofm <span class="keyword">in</span> markups]</span><br></pre></td></tr></table></figure>




<pre><code>[[0, 0, 0, 0, 2, 3, 0, 0, 3],
 [3, 0, 0, 0, 0, 0, 2, 0, 3],
 [0, 4, 0, 4, 4, 5, 3, 4, 5],
 [5, 4, 0, 3, 0, 3, 3, 5, 0],
 [4, 3, 2, 0, 0, 0, 4, 3, 3],
 [0, 3, 4, 3, 0, 0, 0, 4, 3],
 [4, 4, 2, 0, 4, 3, 0, 2, 0],
 [4, 0, 2, 0, 3, 3, 0, 0, 2],
 [3, 0, 0, 2, 2, 0, 0, 0, 0]]
</code></pre>
<p>This line gives the length (or the number of) of markups in each cell. 0 implies the cell that is already filled in.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line">markups = get_markup(grid)</span><br><span class="line">previous_markups = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_definite</span>(<span class="params">markups</span>):</span><br><span class="line">    markup_len = [[<span class="built_in">len</span>(m) <span class="keyword">for</span> m <span class="keyword">in</span> listofm] <span class="keyword">for</span> listofm <span class="keyword">in</span> markups]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> markup_len:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> <span class="keyword">in</span> row:</span><br><span class="line">            <span class="keyword">return</span> (markup_len.index(row), row.index(<span class="number">1</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> markups != previous_markups:</span><br><span class="line">    </span><br><span class="line">    previous_markups = markups</span><br><span class="line">    </span><br><span class="line">    def_row, def_col = next_definite(markups)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> def_row <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        grid[def_row][def_col] = markups[def_row][def_col][<span class="number">0</span>]</span><br><span class="line">        markups = get_markup(grid)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        markup = markups[row]</span><br><span class="line">        preemptives = get_preemptive(markup)</span><br><span class="line">        markup = reduce_markup(markup, preemptives)</span><br><span class="line">        markups[row] = markup</span><br><span class="line">    </span><br><span class="line">    markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups)))</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        markup = markups[col]</span><br><span class="line">        preemptives = get_preemptive(markup)</span><br><span class="line">        markup = reduce_markup(markup, preemptives)</span><br><span class="line">        markups[col] = markup</span><br><span class="line">    markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups))) </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">        markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">        preemptives = get_preemptive(markup)</span><br><span class="line">        markup = reduce_markup(markup, preemptives)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<p>Now we have reached the step where the markup can no longer be reduced and we do not have solution yet. We will make a guess on the first empty cell available, then repeat the above step. To make this easier, we will make the above block of codes function.</p>
<p><img src="http://pi.math.cornell.edu/~mec/Summer2009/meerkamp/Site/Solving_any_Sudoku_II_files/mepham_markup.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">crook</span>(<span class="params">grid</span>):</span><br><span class="line">    </span><br><span class="line">    markups = get_markup(grid)</span><br><span class="line">    previous_markups = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> markups != previous_markups:</span><br><span class="line"></span><br><span class="line">        previous_markups = markups</span><br><span class="line"></span><br><span class="line"><span class="comment">#         def_row, def_col = next_definite(markups)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         if def_row is not None:</span></span><br><span class="line"><span class="comment">#             grid[def_row][def_col] = markups[def_row][def_col][0]</span></span><br><span class="line"><span class="comment">#             markups = get_markup(grid)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[row]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[row] = markup</span><br><span class="line"></span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups)))</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[col]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[col] = markup</span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups))) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">            markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">                markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br><span class="line">    </span><br><span class="line">    empty_row, empty_col = next_empty(grid)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> empty_row <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span>(grid)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> guess <span class="keyword">in</span> markups[empty_row][empty_col]:</span><br><span class="line">        <span class="comment">#print(&quot;Guess in (&#123;r&#125;,&#123;c&#125;):&#123;n&#125;&quot;.format(r=empty_row, c=empty_col, n=guess))</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> check_conditions(grid, empty_row, empty_col, guess):</span><br><span class="line">            grid[empty_row][empty_col] = guess</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> crook(grid):</span><br><span class="line">                <span class="keyword">return</span>(grid)</span><br><span class="line">        </span><br><span class="line">        grid[empty_row][empty_col] = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grid = [[<span class="number">2</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">8</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">9</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>],</span><br><span class="line">         [<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>]]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grid_sol = crook(grid)</span><br><span class="line">grid_sol</span><br></pre></td></tr></table></figure>




<pre><code>[[2, 9, 5, 7, 4, 3, 8, 6, 1],
 [4, 3, 1, 8, 6, 5, 9, 2, 7],
 [8, 7, 6, 1, 9, 2, 5, 4, 3],
 [3, 8, 7, 4, 5, 9, 2, 1, 6],
 [6, 1, 2, 3, 8, 7, 4, 9, 5],
 [5, 4, 9, 2, 1, 6, 7, 3, 8],
 [7, 6, 3, 5, 2, 4, 1, 8, 9],
 [9, 2, 8, 6, 7, 1, 3, 5, 4],
 [1, 5, 4, 9, 3, 8, 6, 7, 2]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validateSolution(grid_sol)</span><br></pre></td></tr></table></figure>




<pre><code>True
</code></pre>
<p>Voila! We solved the sudoku puzzle with the Crook’s algorithm.</p>
<p>Below is the code put together so that you can try it yourselves!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check_conditions</span>(<span class="params">grid, row, col, n</span>):   </span><br><span class="line">    <span class="comment">## check_conditions: list of lists, int, int, int -&gt; boolean</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> grid[row]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([r[col] == n <span class="keyword">for</span> r <span class="keyword">in</span> grid]):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    r_start = (row // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    c_start = (col // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r, c <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">        <span class="keyword">if</span> grid[r_start + r][c_start + c] == n:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_markup</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## get_markup(): listof listof int -&gt; listof listof int</span></span><br><span class="line">    <span class="comment">## This helper function returns a list of list of integers</span></span><br><span class="line">    <span class="comment">## where each list of integer is a markup of a corresponding cell </span></span><br><span class="line">    markup_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        r = [[]]*<span class="number">9</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = []</span><br><span class="line">            <span class="keyword">if</span> grid[row][col] != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> check_conditions(grid, row, col, candidate):</span><br><span class="line">                    markup.append(candidate)</span><br><span class="line"></span><br><span class="line">            r[col] = markup</span><br><span class="line"></span><br><span class="line">        markup_list.append(r)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span>(markup_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_preemptive</span>(<span class="params">listofMarkup</span>):</span><br><span class="line">    </span><br><span class="line">    preemptive_list = []</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> listofMarkup:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(m) == listofMarkup.count(m):</span><br><span class="line">                <span class="keyword">if</span> m <span class="keyword">not</span> <span class="keyword">in</span> preemptive_list:</span><br><span class="line">                    preemptive_list.append(m)</span><br><span class="line">    <span class="keyword">return</span>(preemptive_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reduce_markup</span>(<span class="params">listofMarkup, preemptive_list</span>):</span><br><span class="line">    <span class="comment"># compute row-, col- or subgrid-wise</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(preemptive_list) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span>(listofMarkup)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> preemptive_list:</span><br><span class="line">        <span class="keyword">return</span>([[m <span class="keyword">for</span> m <span class="keyword">in</span> l <span class="keyword">if</span> (m <span class="keyword">not</span> <span class="keyword">in</span> p)] <span class="keyword">if</span> l != p <span class="keyword">else</span> p <span class="keyword">for</span> l <span class="keyword">in</span> listofMarkup])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_empty</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="comment">## next_empty(): listof lists -&gt; int, int</span></span><br><span class="line">    <span class="comment">## next_empty() is a helper function that searches for the next empty cell in the given sudoku puzzle</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> grid:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> row:</span><br><span class="line">            <span class="keyword">return</span> (grid.index(row), row.index(<span class="number">0</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crook</span>(<span class="params">grid</span>):</span><br><span class="line">    </span><br><span class="line">    markups = get_markup(grid)</span><br><span class="line">    previous_markups = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> markups != previous_markups:</span><br><span class="line"></span><br><span class="line">        previous_markups = markups</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[row]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[row] = markup</span><br><span class="line"></span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups)))</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            markup = markups[col]</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line">            markups[col] = markup</span><br><span class="line">        markups = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">list</span>, <span class="built_in">zip</span>(*markups))) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> r_s, c_s <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>), <span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            markup = [r[c_s * <span class="number">3</span>:c_s * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> r <span class="keyword">in</span> markups[r_s * <span class="number">3</span>:r_s * <span class="number">3</span> + <span class="number">3</span>]]</span><br><span class="line">            markup = <span class="built_in">list</span>(itertools.chain(*markup))</span><br><span class="line">            preemptives = get_preemptive(markup)</span><br><span class="line">            markup = reduce_markup(markup, preemptives)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">                markups[r_s * <span class="number">3</span> + i][c_s * <span class="number">3</span>: c_s * <span class="number">3</span> + <span class="number">3</span>] = markup[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]</span><br><span class="line">    </span><br><span class="line">    empty_row, empty_col = next_empty(grid)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> empty_row <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span>(grid)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> guess <span class="keyword">in</span> markups[empty_row][empty_col]:</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> check_conditions(grid, empty_row, empty_col, guess):</span><br><span class="line">            grid[empty_row][empty_col] = guess</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> crook(grid):</span><br><span class="line">                <span class="keyword">return</span>(grid)</span><br><span class="line">        </span><br><span class="line">        grid[empty_row][empty_col] = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validateSolution</span>(<span class="params">sudoku</span>):</span><br><span class="line">    <span class="comment">## To check if it is a valid solution:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## If any cell is empty:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([<span class="number">0</span> <span class="keyword">in</span> row <span class="keyword">for</span> row <span class="keyword">in</span> sudoku]):</span><br><span class="line">        <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> sudoku:</span><br><span class="line">            <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> row:</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> [r[col] <span class="keyword">for</span> r <span class="keyword">in</span> sudoku]:</span><br><span class="line">                    <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">        <span class="comment">## In fact, if row and column-wise conditions are met, then subgrid condition is automatically met. </span></span><br><span class="line">        <span class="comment">## But we want to check it explicitly.</span></span><br><span class="line">        <span class="keyword">for</span> r_start, c_start <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>),<span class="built_in">range</span>(<span class="number">3</span>)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>([n <span class="keyword">not</span> <span class="keyword">in</span> row[c_start * <span class="number">3</span>: c_start * <span class="number">3</span> + <span class="number">3</span>] <span class="keyword">for</span> row <span class="keyword">in</span> grid[r_start * <span class="number">3</span>: r_start * <span class="number">3</span> + <span class="number">3</span>]]):</span><br><span class="line">                <span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span>(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2022/04/09/2021-06-23-Sudoku%20-%20Part%202/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 Michael Hur. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Michael Hur</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-zoi9cv3fxbuk68sxg0xkjhah3klemljfujipeswdtomoblnegzlm06beywp6.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
